<!DOCTYPE html>
<!-- saved from url=(0116)http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript" async="" src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/ados"></script>
    
    <title>python - Search for string allowing for one mismatch in any location of the string - Stack Overflow</title>
    <link rel="shortcut icon" href="http://cdn.sstatic.net/stackoverflow/img/favicon.ico">
    <link rel="apple-touch-icon image_src" href="http://cdn.sstatic.net/stackoverflow/img/apple-touch-icon.png">
    <link rel="search" type="application/opensearchdescription+xml" title="Stack Overflow" href="http://stackoverflow.com/opensearch.xml">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:domain" content="stackoverflow.com">
    <meta name="og:type" content="website">
    <meta name="og:image" content="http://cdn.sstatic.net/stackoverflow/img/apple-touch-icon@2.png?v=fde65a5a78c6">
    <meta name="og:title" content="Search for string allowing for one mismatch in any location of the string">
    <meta name="og:description" content="I am working with DNA sequences of length 25 (see examples below). I have a list of 230,000 and need to look for each sequence in the entire genome (toxoplasma gondii parasite). I am not sure how l...">
    <meta name="og:url" content="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string">
    <link rel="canonical" href="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/python - Search for string allowing for one mismatch in any location of the string - Stack Overflow.html">

    
    
    <script type="text/javascript" async="" src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/quant.js"></script><script async="" src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/beacon.js"></script><script async="" src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/analytics.js"></script><script type="text/javascript" async="" src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/ados.js"></script><script type="text/javascript" src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/jquery.min.js"></script>
    <script src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/stub.en.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/all.css">
    
    <link rel="alternate" type="application/atom+xml" title="Feed for question &#39;Search for string allowing for one mismatch in any location of the string&#39;" href="http://stackoverflow.com/feeds/question/2420412">
    <script type="text/javascript">
        
        StackExchange.ready(function () {
            StackExchange.using("postValidation", function () {
                StackExchange.postValidation.initOnBlurAndSubmit($('#post-form'), 2, 'answer');
            });

            
            StackExchange.question.init({showAnswerHelp:true,totalCommentCount:1,shownCommentCount:1,highlightColor:'#F4A83D',backgroundColor:'#FFF',questionId:2420412});

            styleCode();

                StackExchange.realtime.subscribeToQuestion('1', '2420412');
            
                    });
    </script>


    <script type="text/javascript">
        StackExchange.init({"locale":"en","stackAuthUrl":"https://stackauth.com","serverTime":1390800507,"styleCode":true,"enableUserHovercards":true,"site":{"name":"Stack Overflow","description":"Q&A for professional and enthusiast programmers","isNoticesTabEnabled":true,"recaptchaPublicKey":"6LdchgIAAAAAAJwGpIzRQSOFaO0pU6s44Xt8aTwc","recaptchaAudioLang":"en","nonAsciiTags":true,"enableSocialMediaInSharePopup":true},"user":{"fkey":"5be5aa6d86002f77879c88035743a3e3","isAnonymous":true,"ab":{"welcome_email":{"v":"c","g":1},"anonymoushero":{"v":"bias2","g":2}}}});
        StackExchange.using.setCacheBreakers({"js/prettify-full.en.js":"e0bbd4760e83","js/moderator.en.js":"f24049d774be","js/full-anon.en.js":"9f2bf11519b2","js/full.en.js":"9fbd88448c92","js/wmd.en.js":"849f408083f3","js/third-party/jquery.autocomplete.min.js":"e5f01e97f7c3","js/third-party/jquery.autocomplete.min.en.js":"","js/mobile.en.js":"6db6f78458f8","js/help.en.js":"d3cc74d8a93a","js/tageditor.en.js":"6d51a5f8d7f3","js/tageditornew.en.js":"5761dfb80bd0","js/inline-tag-editing.en.js":"f951bd09dc69","js/revisions.en.js":"33fd38144303","js/review.en.js":"44c8a0044283","js/tagsuggestions.en.js":"e4e7b952fcc7","js/post-validation.en.js":"c275fe37d674","js/explore-qlist.en.js":"73825bd006fc","js/events.en.js":"c3218f63807f"});
        StackExchange.using("gps", function() {
             StackExchange.gps.init(true);
        });
        
    </script>
    
        <script type="text/javascript">
            StackExchange.ready(function () {
                $('#nav-tour').click(function () {
                    StackExchange.using("gps", function() {
                        StackExchange.gps.track("aboutpage.click", { aboutclick_location: "headermain" }, true);
                    });
                });
            });
        </script>
<script async="" type="text/javascript" src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/full-anon.en.js"></script><script async="" type="text/javascript" src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/post-validation.en.js"></script><script async="" type="text/javascript" src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/prettify-full.en.js"></script><link href="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/sidebar.min.css" type="text/css" rel="stylesheet"><script type="text/javascript" src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/adFeedback.js"></script><link rel="stylesheet" href="http://static.adzerk.net/Extensions/adFeedback.css"></head>
<body class="question-page new-topbar">
    <noscript>&lt;div id="noscript-padding"&gt;&lt;/div&gt;</noscript>
    <div id="notify-container"></div>
    <div id="overlay-header"></div>
    <div id="custom-header"></div>
<div class="topbar">
    <div class="topbar-wrapper">
        
        <div class="js-topbar-dialog-corral">


<div class="topbar-dialog siteSwitcher-dialog dno">
    <div class="header">
        <h3><a href="http://stackexchange.com/sites">Explore our sites</a></h3>
    </div>
    <div class="modal-content">
        <ul class="current-site">
                <li>
                        <div class="related-links">
            <a href="http://chat.stackoverflow.com/" data-gps-track="site_switcher.click({ item_type:6 })">chat</a>
                    <a href="http://blog.stackexchange.com/" data-gps-track="site_switcher.click({ item_type:7 })">blog</a>
            </div>
    <a href="http://stackoverflow.com/" class="current-site-link site-link js-gps-track" data-gps-track="site_switcher.click({ item_type:3 })">
        <div class="site-icon favicon favicon-stackoverflow" title="Stack Overflow"></div>
        Stack Overflow
    </a>

                </li>
                <li class="related-site">
                        <a href="http://meta.stackoverflow.com/" class="site-link js-gps-track" data-gps-track="site.switch({ target_site:4, item_type:3 });site_switcher.click({ item_type:4 })">
        <div class="site-icon favicon favicon-stackoverflowmeta" title="Meta Stack Overflow"></div>
        Meta Stack Overflow
    </a>

                </li>
                            <li class="related-site">
                    <a class="site-link" href="http://careers.stackoverflow.com/" data-gps-track="site_switcher.click({ item_type:9 })">
                        <div class="site-icon favicon favicon-careers" title="Stack Overflow Careers"></div>
                        Careers 2.0
                    </a>
                </li>
        </ul>
        


        
            <div class="child-content"></div>

    </div>
</div>        </div>

        <div class="network-items">
            
            <a href="http://stackexchange.com/" class="topbar-icon icon-site-switcher yes-hover js-site-switcher-button js-gps-track" data-gps-track="site_switcher.show" title="A list of all 116 Stack Exchange sites">
                <span class="hidden-text">Stack Exchange</span>
            </a>
            
        </div>

        <div class="topbar-links">
            
                <div class="links-container">
                    <span class="topbar-menu-links">
                        <a href="http://stackoverflow.com/users/login?returnurl=%2fquestions%2f2420412%2fsearch-for-string-allowing-for-one-mismatch-in-any-location-of-the-string" class="login-link">sign up</a>    
                        <a href="http://stackoverflow.com/users/login?returnurl=%2fquestions%2f2420412%2fsearch-for-string-allowing-for-one-mismatch-in-any-location-of-the-string" class="login-link">log in</a>
                        <a href="http://stackoverflow.com/tour">tour</a>
                            <a href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#" class="icon-help js-help-button" title="Help Center and other resources">
        help
        <span class="triangle"></span>
    </a>
    <div class="topbar-dialog help-dialog js-help-dialog dno">
        <div class="modal-content">
            <ul>
                <li>
                    <a href="http://stackoverflow.com/tour" class="js-gps-track" data-gps-track="help_popup.click({ item_type:1 })">
                        Tour
                        <span class="item-summary">
                            Start here for a quick overview of the site
                        </span>
                    </a>
                </li>
                <li>
                    <a href="http://stackoverflow.com/help" class="js-gps-track" data-gps-track="help_popup.click({ item_type:4 })">
                        Help Center
                        <span class="item-summary">
                            Detailed answers to any questions you might have
                        </span>
                    </a>
                </li>
                    <li>
                        <a href="http://meta.stackoverflow.com/" class="js-gps-track" data-gps-track="help_popup.click({ item_type:2 })">
                            Meta
                            <span class="item-summary">
                                Discuss the workings and policies of this site
                            </span>
                        </a>
                    </li>
            </ul>
        </div>
    </div>

                            <a href="http://careers.stackoverflow.com/">careers 2.0</a>
                    </span>
                </div>

			<div class="search-container">
                <form id="search" action="http://stackoverflow.com/search" method="get" autocomplete="off">
                    <input name="q" type="text" placeholder="search" value="" tabindex="1" autocomplete="off" maxlength="240">
                </form>
			</div>
            	
        </div>      
    </div> 
</div>
<script>
    StackExchange.ready(function () {
        //topbar.init();
        StackExchange.topbar.init();
    });
</script>    <div class="container">
        <div id="header" class="headeranon">
            <br class="cbt">
            <div id="hlogo">
                <a href="http://stackoverflow.com/">
                    Stack Overflow
                </a>
            </div>
            <div id="hmenus">
                <div class="nav mainnavs mainnavsanon">
                    <ul>
                            <li class="youarehere"><a id="nav-questions" href="http://stackoverflow.com/questions">Questions</a></li>
                            <li><a id="nav-tags" href="http://stackoverflow.com/tags">Tags</a></li>
                            <li><a id="nav-tour" href="http://stackoverflow.com/about">Tour</a></li>
                            <li><a id="nav-users" href="http://stackoverflow.com/users">Users</a></li>
                    </ul>
                </div>
                <div class="nav askquestion">
                    <ul>
                        <li>
                            <a id="nav-askquestion" href="http://stackoverflow.com/questions/ask">Ask Question</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        



        <div id="content">
            

<div itemscope="" itemtype="http://schema.org/Article">
	<link itemprop="image" href="http://cdn.sstatic.net/stackoverflow/img/apple-touch-icon.png">
			<!--googleoff: all-->
<div id="herobox-mini">
    <div id="hero-content">
        <span id="controls">
            <a href="http://stackoverflow.com/about" id="tell-me-more" class="button">Take the 2-minute tour</a>
            <span id="close"><a title="click to dismiss">×</a></span>
        </span>
        <div id="blurb">
            Stack Overflow is a question and answer site for professional and enthusiast programmers. It's 100% free, no registration required.
        </div>        
    </div>
    <script>
        $('#tell-me-more').click(function () {
            var clickSource = $("body").attr("class") + '-mini';
            if ($("body").hasClass("questions-page")) {
                clickSource = 'questionpagemini';
            } else if ($("body").hasClass("question-page")) {
                clickSource = 'questionpagemini';
            } else if ($("body").hasClass("home-page")) {
                clickSource = 'homepagemini';
            }

            StackExchange.using("gps", function () {
                StackExchange.gps.track("aboutpage.click", { aboutclick_location: clickSource } , true);
            });
        });
        $('#herobox-mini #close').click(function () {
            StackExchange.using("gps", function () {
                StackExchange.gps.track("hero.action", { hero_action_type: "close" }, true);
            });
            $.cookie("hero", "none", { path: "/" });
            var $hero = $("#herobox-mini");
            $hero.slideUp('fast', function () { $hero.remove(); });
            return false;
        });
    </script>
</div>
			<!--googleon: all-->
			<div id="question-header">
			<h1 itemprop="name"><a href="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/python - Search for string allowing for one mismatch in any location of the string - Stack Overflow.html" class="question-hyperlink">Search for string allowing for one mismatch in any location of the string</a></h1>
		</div>
			<div id="mainbar">

			

<div class="question" data-questionid="2420412" id="question">
    
    <script type="text/javascript">
                var ados = ados || {};ados.run = ados.run || [];
                ados.run.push(function() { ados_add_placement(22,8277,"adzerk184979673",4).setZone(43) ; });                    
            </script>
            <div class="everyonelovesstackoverflow adzerk-vote" id="adzerk184979673"><a href="http://engine.adzerk.net/r?e=eyJhdiI6NDE0LCJhdCI6NCwiY20iOjI5MTEsImNoIjoxMTc4LCJjciI6MTA3NjgsImRpIjoiNGQ0ZjAzN2JlZjdlNDMyYTgzNzY0ZDE2NDU5Mjg2MGIiLCJkbSI6MSwiZmMiOjE2ODc0LCJmbCI6NzQ3Miwia3ciOiJweXRob24sc3RyaW5nLHBhdHRlcm4tbWF0Y2hpbmcsc3RyaW5nLW1hdGNoaW5nLGRuYS1zZXF1ZW5jZSIsIm53IjoyMiwicGMiOjAsInByIjoxNjA0LCJydCI6MSwicmYiOiJodHRwczovL3d3dy5nb29nbGUuY29tLyIsInN0Ijo4Mjc3LCJ6biI6NDMsInRzIjoxMzkwODAwNTA3MjQ5LCJ1ciI6Imh0dHA6Ly9jYXJlZXJzLnN0YWNrb3ZlcmZsb3cuY29tL2pvYnMvdGVsZWNvbW11dGUifQ&s=BDcUUT-xaG5NZP8vpV16aLlfqgY" rel="nofollow" target="_blank" title=""><img src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/a61df59863ed44e59446d0b9bb805c56.jpg" title="" alt="" border="0" width="728" height="90"></a><div class="adzerk-vote-controls" style="display: none;"><div class="adzerk-vote-option adzerk-vote-up"><div class="adzerk-vote-icon"></div></div><div class="adzerk-vote-option adzerk-vote-down"><div class="adzerk-vote-icon"></div></div></div><div class="adzerk-vote-survey" style="display:none;"><form><span>No problem. We won't show you that ad again. Why didn't you like it?</span><ul><li><label><input type="radio" value="12" name="downvoteReason">Uninteresting</label></li><li><label><input type="radio" value="13" name="downvoteReason">Misleading</label></li><li><label><input type="radio" value="14" name="downvoteReason">Offensive</label></li><li><label><input type="radio" value="15" name="downvoteReason">Repetitive</label></li></ul><a href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#" class="adzerk-vote-cancel">Oops! I didn't mean to do this.</a></form></div><img height="0px" width="0px" border="0" src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/i.gif"></div>    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="2420412">
    <a class="vote-up-off" title="This question shows research effort; it is useful and clear">up vote</a>
    <span class="vote-count-post ">10</span>
    <a class="vote-down-off" title="This question does not show any research effort; it is unclear or not useful">down vote</a>
    
    <a class="star-off" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#" title="This is a favorite question (click again to undo)">favorite</a>
    <div class="favoritecount"><b>7</b></div>   

</div>

            </td>
            
<td class="postcell">
<div>
    <div class="post-text" itemprop="description">

        <p>I am working with DNA sequences of length 25 (see examples below). I have a list of 230,000 and need to look for each sequence in the entire genome (toxoplasma gondii parasite). I am not sure how large the genome is, but much longer than 230,000 sequences.</p>

<p>I need to look for each of my sequences of 25 characters, for example,  (AGCCTCCCATGATTGAACAGATCAT).</p>

<p>The genome is formatted as a continuous string, i.e. (CATGGGAGGCTTGCGGAGCCTGAGGGCGGAGCCTGAGGTGGGAGGCTTGCGGAGTGCGGAGCCTGAGCCTGAGGGCGGAGCCTGAGGTGGGAGGCTT....)</p>

<p>I don't care where or how many times it is found, only whether it is or not.<br>
This is simple I think --  </p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">str</span><span class="pun">.</span><span class="pln">find</span><span class="pun">(</span><span class="pln">AGCCTCCCATGATTGAACAGATCAT</span><span class="pun">)</span></code></pre>

<p>But I also what to find a close match defined as wrong (mismatched) at any location, but only one location, and record the location in the sequence. I am not sure how do do this. The only thing I can think of is using a wildcard and performing the search with a wildcard in each position. I.e., search 25 times.</p>

<p>For example,<br>
AGCCTCCCATGATTGAACAGATCAT<br>
AGCCTCCCATGATAGAACAGATCAT</p>

<p>A close match with a mismatch at position 13.</p>

<p>Speed is not a big issue because I am only doing it 3 times, though it would be nice if it was fast.</p>

<p>There are programs that do this -- find matches and partial matches -- but I am looking for a type of partial match that is not discoverable with these applications.</p>

<p>Here is a similar post for perl, although they are only comparing sequences and not searching a continuous string : </p>

<p><a href="http://stackoverflow.com/questions/1672782/fastest-way-to-find-mismatch-positions-between-two-strings-of-the-same-length">Related post</a></p>

    </div>
    <div class="post-taglist">
        <a href="http://stackoverflow.com/questions/tagged/python" class="post-tag js-gps-track" title="show questions tagged &#39;python&#39;" rel="tag">python</a> <a href="http://stackoverflow.com/questions/tagged/string" class="post-tag js-gps-track" title="show questions tagged &#39;string&#39;" rel="tag">string</a> <a href="http://stackoverflow.com/questions/tagged/pattern-matching" class="post-tag js-gps-track" title="show questions tagged &#39;pattern-matching&#39;" rel="tag">pattern-matching</a> <a href="http://stackoverflow.com/questions/tagged/string-matching" class="post-tag js-gps-track" title="show questions tagged &#39;string-matching&#39;" rel="tag">string-matching</a> <a href="http://stackoverflow.com/questions/tagged/dna-sequence" class="post-tag js-gps-track" title="show questions tagged &#39;dna-sequence&#39;" rel="tag">dna-sequence</a> 
    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="http://stackoverflow.com/q/2420412" title="short permalink to this question" class="short-link" id="link-post-2420412">share</a><span class="lsep">|</span><a href="http://stackoverflow.com/posts/2420412/edit" class="suggest-edit-post" title="">improve this question</a></div>        
    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="http://stackoverflow.com/posts/2420412/revisions" title="show all edits to this post">edited <span title="2011-03-22 05:42:54Z" class="relativetime">Mar 22 '11 at 5:42</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="http://stackoverflow.com/users/373539/belacqua"><div><img src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/5916afc84a5241c2671d2a90a9868871" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="http://stackoverflow.com/users/373539/belacqua">belacqua</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">296</span><span title="3 silver badges"><span class="badge2"></span><span class="badgecount">3</span></span><span title="12 bronze badges"><span class="badge3"></span><span class="badgecount">12</span></span>
    </div>
</div>    </td>
    <td class="post-signature owner">
        <div class="user-info ">
    <div class="user-action-time">
        asked <span title="2010-03-10 20:42:30Z" class="relativetime">Mar 10 '10 at 20:42</span>
    </div>
    <div class="user-gravatar32">
        <a href="http://stackoverflow.com/users/192406/vincent"><div><img src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/226e40fdc55d4597a46279296a616384" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="http://stackoverflow.com/users/192406/vincent">Vincent</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">481</span><span title="5 silver badges"><span class="badge2"></span><span class="badgecount">5</span></span><span title="20 bronze badges"><span class="badge3"></span><span class="badgecount">20</span></span>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</div>
</td>
        </tr>
<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2420412" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" data-addlink-html="add comment" data-addlink-disabled="true">

    <tr id="comment-2403092" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">Do you need to check for single dropped or added elements?</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/174728/gnibbler" title="93885 reputation" class="comment-user">gnibbler</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment2403092_2420412"><span title="2010-03-10 21:29:56Z" class="relativetime-clean">Mar 10 '10 at 21:29</span></a></span>
				</div>

        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-2420412" data-rep="50" data-anon="true" class="comments-link disabled-link" title="Use comments to ask for more information or suggest improvements. Avoid answering questions in comments.">add comment</a>
    </td>
</tr>            </tbody></table>    
</div>


			<div id="answers">

				<a name="tab-top"></a>
				<div id="answers-header">
					<div class="subheader answers-subheader">
						<h2>
								11 Answers
						</h2>
						<div>
							<div id="tabs">
        <a href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string?answertab=active#tab-top" title="Answers with the latest activity first">active</a>
        <a href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string?answertab=oldest#tab-top" title="Answers in the order they were provided">oldest</a>
        <a class="youarehere" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string?answertab=votes#tab-top" title="Answers with the highest score first">votes</a>
</div>
						</div>
					</div>    
				</div>    




  
<a name="2421378"></a>
<div id="answer-2421378" class="answer accepted-answer" data-answerid="2421378">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="2421378">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">11</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


        <span class="vote-accepted-on load-accepted-answer-date" title="loading when this answer was accepted...">accepted</span>
</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p><strong>Before you read on</strong>, have you looked at <a href="http://biopython.org/wiki/Main_Page">biopython</a>?</p>

<p>It appears that you want to find approximate matches with one substitution error, and zero insertion/deletion errors i.e. a Hamming distance of 1.</p>

<p>If you have a Hamming distance match function (see e.g. the link provided by Ignacio), you could use it like this to do a search for the first match:</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">any</span><span class="pun">(</span><span class="typ">Hamming_distance</span><span class="pun">(</span><span class="pln">genome</span><span class="pun">[</span><span class="pln">x</span><span class="pun">:</span><span class="pln">x</span><span class="pun">+</span><span class="lit">25</span><span class="pun">],</span><span class="pln"> sequence</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">genome</span><span class="pun">)))</span></code></pre>

<p>but this would be rather slow, because (1) the Hamming distance function would keep on grinding after the 2nd substitution error (2) after failure, it advances the cursor by one rather than skipping ahead based on what it saw (like a Boyer-Moore search does).</p>

<p>You can overcome (1) with a function like this:</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="kwd">def</span><span class="pln"> </span><span class="typ">Hamming_check_0_or_1</span><span class="pun">(</span><span class="pln">genome</span><span class="pun">,</span><span class="pln"> posn</span><span class="pun">,</span><span class="pln"> sequence</span><span class="pun">):</span><span class="pln">
    errors </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">25</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> genome</span><span class="pun">[</span><span class="pln">posn</span><span class="pun">+</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> sequence</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln">
            errors </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> errors </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">:</span><span class="pln">
                </span><span class="kwd">return</span><span class="pln"> errors
    </span><span class="kwd">return</span><span class="pln"> errors </span></code></pre>

<p>Note: that's intentionally not Pythonic, it's Cic, because you'd need to use C (perhaps via Cython) to get reasonable speed.</p>

<p>Some work on bit-parallel approximate Levenshtein searches with skipping has been done by Navarro and Raffinot (google "Navarro Raffinot nrgrep") and this could be adapted to Hamming searches. Note that bit-parallel methods have limitations on length of query string and alphabet size but yours are 25 and 4 respectively so no problems there. Update: skipping probably not much help with an alphabet size of 4.</p>

<p>When you google for Hamming distance search, you will notice lots of stuff about implementing it in hardware, and not much in software. This is a big hint that maybe whatever algorithm you come up with ought to be implemented in C or some other compiled language.</p>

<p><strong>Update:</strong>  <strong>Working code for a bit-parallel method</strong></p>

<p>I've also supplied a simplistic method for helping with the correctness checking, and I've packaged a variation of Paul's re code for some comparisons. Note that using re.finditer() delivers non-overlapping results, and this can cause a distance-1 match to shadow an exact match; see my last test case.</p>

<p>The bit-parallel method has these features: guaranteed linear behaviour O(N) where N is text length. Note naive method is O(NM) as is the regex method (M is the pattern length). A Boyer-Moore-style method would be worst case O(NM) and expected O(N). Also the bit-parallel method can be used easily when input has to be buffered: it can be fed a byte or a megabyte at a time; no look-ahead, no problems with buffer boundaries. The big advantage: the speed of that simple per-input-byte code when coded in C.</p>

<p>Downsides: the pattern length is effectively limited to the number of bits in a fast register e.g. 32 or 64. In this case the pattern length is 25; no problem. It uses extra memory (S_table) proportional to the number of distinct characters in the pattern. In this case, the "alphabet size" is only 4; no problem.</p>

<p>Details from <a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.20.8854">this technical report</a>. The algorithm there is for approximate search usin Levenshtein distance. To convert to using Hamming distance, I simply (!) removed the pieces of statement 2.1 that handle insertion and deletion. You'll notice lots of reference to "R" with a "d" superscript. "d" is distance. We need only 0 and 1. These "R"s become the R0 and R1 variables in the code below.</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="com"># coding: ascii</span><span class="pln">

</span><span class="kwd">from</span><span class="pln"> collections </span><span class="kwd">import</span><span class="pln"> defaultdict
</span><span class="kwd">import</span><span class="pln"> re

_DEBUG </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">


</span><span class="com"># "Fast Text Searching with Errors" by Sun Wu and Udi Manber</span><span class="pln">
</span><span class="com"># TR 91-11, Dept of Computer Science, University of Arizona, June 1991.</span><span class="pln">
</span><span class="com"># http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.20.8854</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> WM_approx_Ham1_search</span><span class="pun">(</span><span class="pln">pattern</span><span class="pun">,</span><span class="pln"> text</span><span class="pun">):</span><span class="pln">
    </span><span class="str">"""Generate (Hamming_dist, start_offset)
    for matches with distance 0 or 1"""</span><span class="pln">
    m </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">pattern</span><span class="pun">)</span><span class="pln">
    S_table </span><span class="pun">=</span><span class="pln"> defaultdict</span><span class="pun">(</span><span class="pln">int</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> c </span><span class="kwd">in</span><span class="pln"> enumerate</span><span class="pun">(</span><span class="pln">pattern</span><span class="pun">):</span><span class="pln">
        S_table</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln"> </span><span class="pun">|=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> i
    R0 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    R1 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    mask </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">m </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> j</span><span class="pun">,</span><span class="pln"> c </span><span class="kwd">in</span><span class="pln"> enumerate</span><span class="pun">(</span><span class="pln">text</span><span class="pun">):</span><span class="pln">
        S </span><span class="pun">=</span><span class="pln"> S_table</span><span class="pun">[</span><span class="pln">c</span><span class="pun">]</span><span class="pln">
        shR0 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">R0 </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        R0 </span><span class="pun">=</span><span class="pln"> shR0 </span><span class="pun">&amp;</span><span class="pln"> S
        R1 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">R1 </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> S </span><span class="pun">|</span><span class="pln"> shR0
        </span><span class="kwd">if</span><span class="pln"> _DEBUG</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"j= %2d msk=%s S=%s R0=%s R1=%s"</span><span class="pln"> \
                </span><span class="pun">%</span><span class="pln"> tuple</span><span class="pun">([</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> map</span><span class="pun">(</span><span class="pln">bitstr</span><span class="pun">,</span><span class="pln"> </span><span class="pun">[</span><span class="pln">mask</span><span class="pun">,</span><span class="pln"> S</span><span class="pun">,</span><span class="pln"> R0</span><span class="pun">,</span><span class="pln"> R1</span><span class="pun">]))</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> R0 </span><span class="pun">&amp;</span><span class="pln"> mask</span><span class="pun">:</span><span class="pln"> </span><span class="com"># exact match</span><span class="pln">
            </span><span class="kwd">yield</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> j </span><span class="pun">-</span><span class="pln"> m </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">elif</span><span class="pln"> R1 </span><span class="pun">&amp;</span><span class="pln"> mask</span><span class="pun">:</span><span class="pln"> </span><span class="com"># match with one substitution</span><span class="pln">
            </span><span class="kwd">yield</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> j </span><span class="pun">-</span><span class="pln"> m </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">

</span><span class="kwd">if</span><span class="pln"> _DEBUG</span><span class="pun">:</span><span class="pln">

    </span><span class="kwd">def</span><span class="pln"> bitstr</span><span class="pun">(</span><span class="pln">num</span><span class="pun">,</span><span class="pln"> mlen</span><span class="pun">=</span><span class="lit">8</span><span class="pun">):</span><span class="pln">
       wstr </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pln">
       </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">mlen</span><span class="pun">):</span><span class="pln">
          </span><span class="kwd">if</span><span class="pln"> num </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">:</span><span class="pln">
             wstr </span><span class="pun">=</span><span class="pln"> </span><span class="str">"1"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> wstr
          </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
             wstr </span><span class="pun">=</span><span class="pln"> </span><span class="str">"0"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> wstr
          num </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
       </span><span class="kwd">return</span><span class="pln"> wstr

</span><span class="kwd">def</span><span class="pln"> </span><span class="typ">Ham_dist</span><span class="pun">(</span><span class="pln">s1</span><span class="pun">,</span><span class="pln"> s2</span><span class="pun">):</span><span class="pln">
    </span><span class="str">"""Calculate Hamming distance between 2 sequences."""</span><span class="pln">
    </span><span class="kwd">assert</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">s1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">s2</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> sum</span><span class="pun">(</span><span class="pln">c1 </span><span class="pun">!=</span><span class="pln"> c2 </span><span class="kwd">for</span><span class="pln"> c1</span><span class="pun">,</span><span class="pln"> c2 </span><span class="kwd">in</span><span class="pln"> zip</span><span class="pun">(</span><span class="pln">s1</span><span class="pun">,</span><span class="pln"> s2</span><span class="pun">))</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> long_check</span><span class="pun">(</span><span class="pln">pattern</span><span class="pun">,</span><span class="pln"> text</span><span class="pun">):</span><span class="pln">
    </span><span class="str">"""Naively and understandably generate (Hamming_dist, start_offset)
    for matches with distance 0 or 1"""</span><span class="pln">
    m </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">pattern</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">text</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> m </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">):</span><span class="pln">
        d </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Ham_dist</span><span class="pun">(</span><span class="pln">pattern</span><span class="pun">,</span><span class="pln"> text</span><span class="pun">[</span><span class="pln">i</span><span class="pun">:</span><span class="pln">i</span><span class="pun">+</span><span class="pln">m</span><span class="pun">])</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> d </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">2</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">yield</span><span class="pln"> d</span><span class="pun">,</span><span class="pln"> i

</span><span class="kwd">def</span><span class="pln"> </span><span class="typ">Paul_McGuire_regex</span><span class="pun">(</span><span class="pln">pattern</span><span class="pun">,</span><span class="pln"> text</span><span class="pun">):</span><span class="pln">
    searchSeqREStr </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">
        </span><span class="str">'('</span><span class="pln">
        </span><span class="pun">+</span><span class="pln"> pattern
        </span><span class="pun">+</span><span class="pln"> </span><span class="str">')|('</span><span class="pln">
        </span><span class="pun">+</span><span class="pln"> </span><span class="str">')|('</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">
            pattern</span><span class="pun">[:</span><span class="pln">i</span><span class="pun">]</span><span class="pln">
            </span><span class="pun">+</span><span class="pln"> </span><span class="str">"[ACTGN]"</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="str">''</span><span class="pun">)</span><span class="pln">
            </span><span class="pun">+</span><span class="pln"> pattern</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">:]</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">,</span><span class="pln">c </span><span class="kwd">in</span><span class="pln"> enumerate</span><span class="pun">(</span><span class="pln">pattern</span><span class="pun">)</span><span class="pln">
            </span><span class="pun">)</span><span class="pln">
        </span><span class="pun">+</span><span class="pln"> </span><span class="str">')'</span><span class="pln">
        </span><span class="pun">)</span><span class="pln">
    searchSeqRE </span><span class="pun">=</span><span class="pln"> re</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="pln">searchSeqREStr</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> match </span><span class="kwd">in</span><span class="pln"> searchSeqRE</span><span class="pun">.</span><span class="pln">finditer</span><span class="pun">(</span><span class="pln">text</span><span class="pun">):</span><span class="pln">
        locn </span><span class="pun">=</span><span class="pln"> match</span><span class="pun">.</span><span class="pln">start</span><span class="pun">()</span><span class="pln">
        dist </span><span class="pun">=</span><span class="pln"> int</span><span class="pun">(</span><span class="pln">bool</span><span class="pun">(</span><span class="pln">match</span><span class="pun">.</span><span class="pln">lastindex </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">))</span><span class="pln">
        </span><span class="kwd">yield</span><span class="pln"> dist</span><span class="pun">,</span><span class="pln"> locn


</span><span class="kwd">if</span><span class="pln"> __name__ </span><span class="pun">==</span><span class="pln"> </span><span class="str">"__main__"</span><span class="pun">:</span><span class="pln">

    genome1 </span><span class="pun">=</span><span class="pln"> </span><span class="str">"TTTACGTAAACTAAACTGTAA"</span><span class="pln">
    </span><span class="com">#         01234567890123456789012345</span><span class="pln">
    </span><span class="com">#                   1         2</span><span class="pln">

    tests </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">
        </span><span class="pun">(</span><span class="pln">genome1</span><span class="pun">,</span><span class="pln"> </span><span class="str">"ACGT ATGT ACTA ATCG TTTT ATTA TTTA"</span><span class="pun">),</span><span class="pln">
        </span><span class="pun">(</span><span class="str">"T"</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">10</span><span class="pun">,</span><span class="pln"> </span><span class="str">"TTTT"</span><span class="pun">),</span><span class="pln">
        </span><span class="pun">(</span><span class="str">"ACGTCGTAAAA"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"TCGT"</span><span class="pun">),</span><span class="pln"> </span><span class="com"># partial match can shadow an exact match</span><span class="pln">
        </span><span class="pun">]</span><span class="pln">

    nfailed </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> genome</span><span class="pun">,</span><span class="pln"> patterns </span><span class="kwd">in</span><span class="pln"> tests</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"genome:"</span><span class="pun">,</span><span class="pln"> genome
        </span><span class="kwd">for</span><span class="pln"> pattern </span><span class="kwd">in</span><span class="pln"> patterns</span><span class="pun">.</span><span class="pln">split</span><span class="pun">():</span><span class="pln">
            </span><span class="kwd">print</span><span class="pln"> pattern
            a1 </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">WM_approx_Ham1_search</span><span class="pun">(</span><span class="pln">pattern</span><span class="pun">,</span><span class="pln"> genome</span><span class="pun">))</span><span class="pln">
            a2 </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">long_check</span><span class="pun">(</span><span class="pln">pattern</span><span class="pun">,</span><span class="pln"> genome</span><span class="pun">))</span><span class="pln">
            a3 </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">(</span><span class="typ">Paul_McGuire_regex</span><span class="pun">(</span><span class="pln">pattern</span><span class="pun">,</span><span class="pln"> genome</span><span class="pun">))</span><span class="pln">
            </span><span class="kwd">print</span><span class="pln"> a1
            </span><span class="kwd">print</span><span class="pln"> a2
            </span><span class="kwd">print</span><span class="pln"> a3
            </span><span class="kwd">print</span><span class="pln"> a1 </span><span class="pun">==</span><span class="pln"> a2</span><span class="pun">,</span><span class="pln"> a2 </span><span class="pun">==</span><span class="pln"> a3
            nfailed </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a1 </span><span class="pun">!=</span><span class="pln"> a2 </span><span class="kwd">or</span><span class="pln"> a2 </span><span class="pun">!=</span><span class="pln"> a3</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"***"</span><span class="pun">,</span><span class="pln"> nfailed</span></code></pre>

    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="http://stackoverflow.com/a/2421378" title="short permalink to this answer" class="short-link" id="link-post-2421378">share</a><span class="lsep">|</span><a href="http://stackoverflow.com/posts/2421378/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="http://stackoverflow.com/posts/2421378/revisions" title="show all edits to this post">edited <span title="2010-03-11 21:19:31Z" class="relativetime">Mar 11 '10 at 21:19</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        <br>
        
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2010-03-10 23:09:45Z" class="relativetime">Mar 10 '10 at 23:09</span>
    </div>
    <div class="user-gravatar32">
        <a href="http://stackoverflow.com/users/84270/john-machin"><div><img src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/da2c0de47c3681c58f25b1eb821f7221" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="http://stackoverflow.com/users/84270/john-machin">John Machin</a><br>
        <span class="reputation-score" title="reputation score 36922" dir="ltr">36.9k</span><span title="2 gold badges"><span class="badge1"></span><span class="badgecount">2</span></span><span title="28 silver badges"><span class="badge2"></span><span class="badgecount">28</span></span><span title="90 bronze badges"><span class="badge3"></span><span class="badgecount">90</span></span>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2421378" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="1" data-addlink-html="add comment" data-addlink-disabled="true">

    <tr id="comment-2404270" class="comment">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">1</span>   
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">This is worth a look at the very least to avoid that whole re-inventing the wheel thing!</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/194311/jathanism" title="13936 reputation" class="comment-user">jathanism</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment2404270_2421378"><span title="2010-03-11 00:00:25Z" class="relativetime-clean">Mar 11 '10 at 0:00</span></a></span>
				</div>

        </td>
    </tr>
    <tr id="comment-2404386" class="comment">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">1</span>   
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">I postes this question on biopython. They suggested just using BLAST and parsing the results with python. As the results will include to many/broad of a match result.</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/192406/vincent" title="481 reputation" class="comment-user owner">Vincent</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment2404386_2421378"><span title="2010-03-11 00:24:49Z" class="relativetime-clean">Mar 11 '10 at 0:24</span></a></span>
				</div>

        </td>
    </tr>
    <tr id="comment-11835079" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">What does <code>sh</code> stand for in <code>shR0</code>?</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/707381/randomblue" title="11122 reputation" class="comment-user">Randomblue</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment11835079_2421378"><span title="2012-02-21 02:16:07Z" class="relativetime-clean">Feb 21 '12 at 2:16</span></a></span>
				</div>

        </td>
    </tr>
    <tr id="comment-11838827" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">@Randomblue: shifted</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/84270/john-machin" title="36922 reputation" class="comment-user">John Machin</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment11838827_2421378"><span title="2012-02-21 07:55:13Z" class="relativetime-clean">Feb 21 '12 at 7:55</span></a></span>
				</div>

        </td>
    </tr>
    <tr id="comment-11843643" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">Thanks. Should <code>WM_approx_Ham1_search</code> work smoothly for <code>len(text) &lt; 100000</code>, <code>len(pattern) &lt; len(text)</code> and an alphabet of cardinality 27?</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/707381/randomblue" title="11122 reputation" class="comment-user">Randomblue</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment11843643_2421378"><span title="2012-02-21 12:18:42Z" class="relativetime-clean">Feb 21 '12 at 12:18</span></a></span>
		<span class="edited-yes" title="this comment was edited 1 time"></span>
				</div>

        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-2421378" data-rep="50" data-anon="true" class="comments-link " title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">show <b>1</b> more comment</a>
    </td>
</tr>
    </tbody></table>
</div>
<script type="text/javascript">
                var ados = ados || {};ados.run = ados.run || [];
                ados.run.push(function() { ados_add_placement(22,8277,"adzerk1591688587",4).setZone(44) ; });                    
            </script>
            <div class="everyonelovesstackoverflow adzerk-vote" id="adzerk1591688587"><a href="http://engine.adzerk.net/r?e=eyJhdiI6NDE0LCJhdCI6NCwiY20iOjg0NywiY2giOjExNzgsImNyIjo1OTI0LCJkaSI6ImU1OGFlNGQxMzJiOTQ2ZjY4M2M1ZWJlODFmNTAzYjAyIiwiZG0iOjEsImZjIjo4ODEwLCJmbCI6MjQ0NCwia3ciOiJweXRob24sc3RyaW5nLHBhdHRlcm4tbWF0Y2hpbmcsc3RyaW5nLW1hdGNoaW5nLGRuYS1zZXF1ZW5jZSIsIm53IjoyMiwicGMiOjAsInByIjoxNTY4LCJydCI6MSwicmYiOiJodHRwczovL3d3dy5nb29nbGUuY29tLyIsInN0Ijo4Mjc3LCJ6biI6NDQsInRzIjoxMzkwODAwNTA3MjUxLCJ1ciI6Imh0dHA6Ly9jYXJlZXJzLnN0YWNrb3ZlcmZsb3cuY29tLyJ9&s=SMbh8WcRgdWBiFLF_8mkN81PNeY" rel="nofollow" target="_blank" title=""><img src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/0a96cc99c1784d6abe3cae6b8c8bf013.png" title="" alt="" border="0" width="728" height="90"></a><div class="adzerk-vote-controls" style="display: none;"><div class="adzerk-vote-option adzerk-vote-up"><div class="adzerk-vote-icon"></div></div><div class="adzerk-vote-option adzerk-vote-down"><div class="adzerk-vote-icon"></div></div></div><div class="adzerk-vote-survey" style="display:none;"><form><span>No problem. We won't show you that ad again. Why didn't you like it?</span><ul><li><label><input type="radio" value="12" name="downvoteReason">Uninteresting</label></li><li><label><input type="radio" value="13" name="downvoteReason">Misleading</label></li><li><label><input type="radio" value="14" name="downvoteReason">Offensive</label></li><li><label><input type="radio" value="15" name="downvoteReason">Repetitive</label></li></ul><a href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#" class="adzerk-vote-cancel">Oops! I didn't mean to do this.</a></form></div><img height="0px" width="0px" border="0" src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/i(1).gif"></div>
  
<a name="2420473"></a>
<div id="answer-2420473" class="answer" data-answerid="2420473">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="2420473">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">3</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>You might find the various routines in <a href="http://www.michael-noll.com/wiki/Python-Levenshtein" rel="nofollow">Python-Levenshtein</a> of some use.</p>

    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="http://stackoverflow.com/a/2420473" title="short permalink to this answer" class="short-link" id="link-post-2420473">share</a><span class="lsep">|</span><a href="http://stackoverflow.com/posts/2420473/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2010-03-10 20:49:21Z" class="relativetime">Mar 10 '10 at 20:49</span>
    </div>
    <div class="user-gravatar32">
        <a href="http://stackoverflow.com/users/20862/ignacio-vazquez-abrams"><div><img src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/2343ae368d3241278581ce6c87f62a25" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="http://stackoverflow.com/users/20862/ignacio-vazquez-abrams">Ignacio Vazquez-Abrams</a><br>
        <span class="reputation-score" title="reputation score 281888" dir="ltr">282k</span><span title="25 gold badges"><span class="badge1"></span><span class="badgecount">25</span></span><span title="411 silver badges"><span class="badge2"></span><span class="badgecount">411</span></span><span title="609 bronze badges"><span class="badge3"></span><span class="badgecount">609</span></span>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2420473" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" data-addlink-html="add comment" data-addlink-disabled="true">

    <tr id="comment-2403549" class="comment">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                                <span title="number of &#39;useful comment&#39; votes received" class="cool">3</span>   
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">The closest answer to his question is the function which calculates the Hamming distance between two strings. He needs an approximate <b>search</b> function, not an approximate <b>match</b> function.</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/84270/john-machin" title="36922 reputation" class="comment-user">John Machin</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment2403549_2420473"><span title="2010-03-10 22:16:37Z" class="relativetime-clean">Mar 10 '10 at 22:16</span></a></span>
				</div>

        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-2420473" data-rep="50" data-anon="true" class="comments-link disabled-link" title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add comment</a>
    </td>
</tr>
    </tbody></table>
</div>

  
<a name="2422902"></a>
<div id="answer-2422902" class="answer" data-answerid="2422902">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="2422902">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">3</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>I googled for "toxoplasma gondii parasite genome" to find some of these genome files online.  I found what I think was close, a file titled "TgondiiGenomic_ToxoDB-6.0.fasta" at <a href="http://toxodb.org/" rel="nofollow">http://toxodb.org</a>, about 158Mb in size.  I used the following pyparsing expression to extract the gene sequences, it took just under 2 minutes:</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">fname </span><span class="pun">=</span><span class="pln"> </span><span class="str">"TgondiiGenomic_ToxoDB-6.0.fasta"</span><span class="pln">
fastasrc </span><span class="pun">=</span><span class="pln"> open</span><span class="pun">(</span><span class="pln">fname</span><span class="pun">).</span><span class="pln">read</span><span class="pun">()</span><span class="pln">   </span><span class="com"># yes! just read the whole dang 158Mb!</span><span class="pln">

</span><span class="str">"""
Sample header:
&gt;gb|scf_1104442823584 | organism=Toxoplasma_gondii_VEG | version=2008-07-23 | length=1448
"""</span><span class="pln">
integer </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Word</span><span class="pun">(</span><span class="pln">nums</span><span class="pun">).</span><span class="pln">setParseAction</span><span class="pun">(</span><span class="kwd">lambda</span><span class="pln"> t</span><span class="pun">:</span><span class="pln">int</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]))</span><span class="pln">
genebit </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Group</span><span class="pun">(</span><span class="str">"&gt;gb|"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">Word</span><span class="pun">(</span><span class="pln">printables</span><span class="pun">)(</span><span class="str">"id"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">SkipTo</span><span class="pun">(</span><span class="str">"length="</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> 
                </span><span class="str">"length="</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> integer</span><span class="pun">(</span><span class="str">"genelen"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">LineEnd</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> 
                </span><span class="typ">Combine</span><span class="pun">(</span><span class="typ">OneOrMore</span><span class="pun">(</span><span class="typ">Word</span><span class="pun">(</span><span class="str">"ACGTN"</span><span class="pun">)),</span><span class="pln">adjacent</span><span class="pun">=</span><span class="kwd">False</span><span class="pun">)(</span><span class="str">"gene"</span><span class="pun">))</span><span class="pln">

</span><span class="com"># read gene data from .fasta file - takes just under a couple of minutes</span><span class="pln">
genedata </span><span class="pun">=</span><span class="pln"> </span><span class="typ">OneOrMore</span><span class="pun">(</span><span class="pln">genebit</span><span class="pun">).</span><span class="pln">parseString</span><span class="pun">(</span><span class="pln">fastasrc</span><span class="pun">)</span></code></pre>

<p>(Surprise! some of the gene sequences include runs of 'N's!  What the heck is that about?!)</p>

<p>Then I wrote this class as a subclass of the pyparsing Token class, for doing close matches:</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="kwd">class</span><span class="pln"> </span><span class="typ">CloseMatch</span><span class="pun">(</span><span class="typ">Token</span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">def</span><span class="pln"> __init__</span><span class="pun">(</span><span class="pln">self</span><span class="pun">,</span><span class="pln"> seq</span><span class="pun">,</span><span class="pln"> maxMismatches</span><span class="pun">=</span><span class="lit">1</span><span class="pun">):</span><span class="pln">
        super</span><span class="pun">(</span><span class="typ">CloseMatch</span><span class="pun">,</span><span class="pln">self</span><span class="pun">).</span><span class="pln">__init__</span><span class="pun">()</span><span class="pln">
        self</span><span class="pun">.</span><span class="pln">name </span><span class="pun">=</span><span class="pln"> seq
        self</span><span class="pun">.</span><span class="pln">sequence </span><span class="pun">=</span><span class="pln"> seq
        self</span><span class="pun">.</span><span class="pln">maxMismatches </span><span class="pun">=</span><span class="pln"> maxMismatches
        self</span><span class="pun">.</span><span class="pln">errmsg </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Expected "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">sequence
        self</span><span class="pun">.</span><span class="pln">mayIndexError </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
        self</span><span class="pun">.</span><span class="pln">mayReturnEmpty </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">

    </span><span class="kwd">def</span><span class="pln"> parseImpl</span><span class="pun">(</span><span class="pln"> self</span><span class="pun">,</span><span class="pln"> instring</span><span class="pun">,</span><span class="pln"> loc</span><span class="pun">,</span><span class="pln"> doActions</span><span class="pun">=</span><span class="kwd">True</span><span class="pln"> </span><span class="pun">):</span><span class="pln">
        start </span><span class="pun">=</span><span class="pln"> loc
        instrlen </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">instring</span><span class="pun">)</span><span class="pln">
        maxloc </span><span class="pun">=</span><span class="pln"> start </span><span class="pun">+</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">self</span><span class="pun">.</span><span class="pln">sequence</span><span class="pun">)</span><span class="pln">

        </span><span class="kwd">if</span><span class="pln"> maxloc </span><span class="pun">&lt;=</span><span class="pln"> instrlen</span><span class="pun">:</span><span class="pln">
            seq </span><span class="pun">=</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">sequence
            seqloc </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
            mismatches </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
            throwException </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
            done </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
            </span><span class="kwd">while</span><span class="pln"> loc </span><span class="pun">&lt;</span><span class="pln"> maxloc </span><span class="kwd">and</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> done</span><span class="pun">:</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> instring</span><span class="pun">[</span><span class="pln">loc</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> seq</span><span class="pun">[</span><span class="pln">seqloc</span><span class="pun">]:</span><span class="pln">
                    mismatches</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">seqloc</span><span class="pun">)</span><span class="pln">
                    </span><span class="kwd">if</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">mismatches</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">maxMismatches</span><span class="pun">:</span><span class="pln">
                        throwException </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln">
                        done </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln">
                loc </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
                seqloc </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            throwException </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span><span class="pln">

        </span><span class="kwd">if</span><span class="pln"> throwException</span><span class="pun">:</span><span class="pln">
            exc </span><span class="pun">=</span><span class="pln"> self</span><span class="pun">.</span><span class="pln">myException
            exc</span><span class="pun">.</span><span class="pln">loc </span><span class="pun">=</span><span class="pln"> loc
            exc</span><span class="pun">.</span><span class="pln">pstr </span><span class="pun">=</span><span class="pln"> instring
            </span><span class="kwd">raise</span><span class="pln"> exc

        </span><span class="kwd">return</span><span class="pln"> loc</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="pln">instring</span><span class="pun">[</span><span class="pln">start</span><span class="pun">:</span><span class="pln">loc</span><span class="pun">],</span><span class="pln">mismatches</span><span class="pun">)</span></code></pre>

<p>For every match, this will return a tuple containing the actual string that was matched, and a list of the mismatch locations.  Exact matches would of course return an empty list for the second value.  (I like this class, I think I'll add it to the next release of pyparsing.)</p>

<p>I then ran this code to search for "up-to-2-mismatch" matches in all of the sequences read from the .fasta file (recall that genedata is a sequence of ParseResults groups, each containing an id, an integer length, and a sequence string):</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">searchseq </span><span class="pun">=</span><span class="pln"> </span><span class="typ">CloseMatch</span><span class="pun">(</span><span class="str">"ATCATCGAATGGAATCTAATGGAAT"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> g </span><span class="kwd">in</span><span class="pln"> genedata</span><span class="pun">:</span><span class="pln">
    </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"%s (%d)"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">g</span><span class="pun">.</span><span class="pln">id</span><span class="pun">,</span><span class="pln"> g</span><span class="pun">.</span><span class="pln">genelen</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"-"</span><span class="pun">*</span><span class="lit">24</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> t</span><span class="pun">,</span><span class="pln">startLoc</span><span class="pun">,</span><span class="pln">endLoc </span><span class="kwd">in</span><span class="pln"> searchseq</span><span class="pun">.</span><span class="pln">scanString</span><span class="pun">(</span><span class="pln">g</span><span class="pun">.</span><span class="pln">gene</span><span class="pun">):</span><span class="pln">
        matched</span><span class="pun">,</span><span class="pln"> mismatches </span><span class="pun">=</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
        </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"MATCH:"</span><span class="pun">,</span><span class="pln"> searchseq</span><span class="pun">.</span><span class="pln">sequence
        </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"FOUND:"</span><span class="pun">,</span><span class="pln"> matched
        </span><span class="kwd">if</span><span class="pln"> mismatches</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"      "</span><span class="pun">,</span><span class="pln"> </span><span class="str">''</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="str">' '</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> i </span><span class="kwd">not</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> mismatches </span><span class="kwd">else</span><span class="pln"> </span><span class="str">'*'</span><span class="pln"> 
                            </span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">,</span><span class="pln">c </span><span class="kwd">in</span><span class="pln"> enumerate</span><span class="pun">(</span><span class="pln">searchseq</span><span class="pun">.</span><span class="pln">sequence</span><span class="pun">))</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"&lt;exact match&gt;"</span><span class="pln">
        </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"at location"</span><span class="pun">,</span><span class="pln"> startLoc
        </span><span class="kwd">print</span><span class="pln">
    </span><span class="kwd">print</span></code></pre>

<p>I took the search sequence at random from one of the gene bits, to be sure I could find an exact match, and just out of curiosity to see how many 1- and 2-element mismatches there were.</p>

<p>This took a little while to run.  After 45 minutes, I had this output, listing each id and gene length, and any partial matches found:</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">scf_1104442825154 </span><span class="pun">(</span><span class="lit">964</span><span class="pun">)</span><span class="pln">
</span><span class="pun">------------------------</span><span class="pln">

scf_1104442822828 </span><span class="pun">(</span><span class="lit">942</span><span class="pun">)</span><span class="pln">
</span><span class="pun">------------------------</span><span class="pln">

scf_1104442824510 </span><span class="pun">(</span><span class="lit">987</span><span class="pun">)</span><span class="pln">
</span><span class="pun">------------------------</span><span class="pln">

scf_1104442823180 </span><span class="pun">(</span><span class="lit">1065</span><span class="pun">)</span><span class="pln">
</span><span class="pun">------------------------</span><span class="pln">
</span><span class="pun">...</span></code></pre>

<p>I was getting discouraged, not to see any matches until:</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">scf_1104442823952 </span><span class="pun">(</span><span class="lit">1188</span><span class="pun">)</span><span class="pln">
</span><span class="pun">------------------------</span><span class="pln">
MATCH</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCTAATGGAAT
FOUND</span><span class="pun">:</span><span class="pln"> ATCATCGAACGGAATCGAATGGAAT
                </span><span class="pun">*</span><span class="pln">      </span><span class="pun">*</span><span class="pln">        
at location </span><span class="lit">33</span><span class="pln">

MATCH</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCTAATGGAAT
FOUND</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCGAATGGAAT
                       </span><span class="pun">*</span><span class="pln">        
at location </span><span class="lit">175</span><span class="pln">

MATCH</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCTAATGGAAT
FOUND</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCGAATGGAAT
                       </span><span class="pun">*</span><span class="pln">        
at location </span><span class="lit">474</span><span class="pln">

MATCH</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCTAATGGAAT
FOUND</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCGAATGGAAT
                       </span><span class="pun">*</span><span class="pln">        
at location </span><span class="lit">617</span><span class="pln">

MATCH</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCTAATGGAAT
FOUND</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCGAATAGAAT
                       </span><span class="pun">*</span><span class="pln">   </span><span class="pun">*</span><span class="pln">    
at location </span><span class="lit">718</span><span class="pln">

MATCH</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCTAATGGAAT
FOUND</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGATTCGAATGGAAT
                    </span><span class="pun">*</span><span class="pln">  </span><span class="pun">*</span><span class="pln">        
at location </span><span class="lit">896</span><span class="pln">

MATCH</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCTAATGGAAT
FOUND</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCGAATGGTAT
                       </span><span class="pun">*</span><span class="pln">     </span><span class="pun">*</span><span class="pln">  
at location </span><span class="lit">945</span></code></pre>

<p>And finally my exact match at:</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">scf_1104442823584 </span><span class="pun">(</span><span class="lit">1448</span><span class="pun">)</span><span class="pln">
</span><span class="pun">------------------------</span><span class="pln">
MATCH</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCTAATGGAAT
FOUND</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGACTCGAATGGAAT
                    </span><span class="pun">*</span><span class="pln">  </span><span class="pun">*</span><span class="pln">        
at location </span><span class="lit">177</span><span class="pln">

MATCH</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCTAATGGAAT
FOUND</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCAAATGGAAT
                       </span><span class="pun">*</span><span class="pln">        
at location </span><span class="lit">203</span><span class="pln">

MATCH</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCTAATGGAAT
FOUND</span><span class="pun">:</span><span class="pln"> ATCATCAAATGGAATCGAATGGAAT
             </span><span class="pun">*</span><span class="pln">         </span><span class="pun">*</span><span class="pln">        
at location </span><span class="lit">350</span><span class="pln">

MATCH</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCTAATGGAAT
FOUND</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCGAATGGAAA
                       </span><span class="pun">*</span><span class="pln">       </span><span class="pun">*</span><span class="pln">
at location </span><span class="lit">523</span><span class="pln">

MATCH</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCTAATGGAAT
FOUND</span><span class="pun">:</span><span class="pln"> ATCATCAAATGGAATCGAATGGAAT
             </span><span class="pun">*</span><span class="pln">         </span><span class="pun">*</span><span class="pln">        
at location </span><span class="lit">822</span><span class="pln">

MATCH</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCTAATGGAAT
FOUND</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCTAATGGAAT
</span><span class="pun">&lt;</span><span class="pln">exact match</span><span class="pun">&gt;</span><span class="pln">
at location </span><span class="lit">848</span><span class="pln">

MATCH</span><span class="pun">:</span><span class="pln"> ATCATCGAATGGAATCTAATGGAAT
FOUND</span><span class="pun">:</span><span class="pln"> ATCGTCGAATGGAGTCTAATGGAAT
          </span><span class="pun">*</span><span class="pln">         </span><span class="pun">*</span><span class="pln">           
at location </span><span class="lit">969</span></code></pre>

<p>So while this didn't set any speed records, I got the job done, and found some 2-matches too, in case they might be of interest.</p>

<p>For comparison, here is an RE-based version, that finds 1-mismatch matches only:</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="kwd">import</span><span class="pln"> re
seqStr </span><span class="pun">=</span><span class="pln"> </span><span class="str">"ATCATCGAATGGAATCTAATGGAAT"</span><span class="pln">
searchSeqREStr </span><span class="pun">=</span><span class="pln"> seqStr </span><span class="pun">+</span><span class="pln"> </span><span class="str">'|'</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> \
    </span><span class="str">'|'</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">seqStr</span><span class="pun">[:</span><span class="pln">i</span><span class="pun">]+</span><span class="str">"[ACTGN]"</span><span class="pun">.</span><span class="pln">replace</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="str">''</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln">seqStr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">:]</span><span class="pln"> 
             </span><span class="kwd">for</span><span class="pln"> i</span><span class="pun">,</span><span class="pln">c </span><span class="kwd">in</span><span class="pln"> enumerate</span><span class="pun">(</span><span class="pln">seqStr</span><span class="pun">))</span><span class="pln">

searchSeqRE </span><span class="pun">=</span><span class="pln"> re</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="pln">searchSeqREStr</span><span class="pun">)</span><span class="pln">

</span><span class="kwd">for</span><span class="pln"> g </span><span class="kwd">in</span><span class="pln"> genedata</span><span class="pun">:</span><span class="pln">
    </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"%s (%d)"</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">g</span><span class="pun">.</span><span class="pln">id</span><span class="pun">,</span><span class="pln"> g</span><span class="pun">.</span><span class="pln">genelen</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"-"</span><span class="pun">*</span><span class="lit">24</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> match </span><span class="kwd">in</span><span class="pln"> searchSeqRE</span><span class="pun">.</span><span class="pln">finditer</span><span class="pun">(</span><span class="pln">g</span><span class="pun">.</span><span class="pln">gene</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"MATCH:"</span><span class="pun">,</span><span class="pln"> seqStr
        </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"FOUND:"</span><span class="pun">,</span><span class="pln"> match</span><span class="pun">.</span><span class="pln">group</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"at location"</span><span class="pun">,</span><span class="pln"> match</span><span class="pun">.</span><span class="pln">start</span><span class="pun">()</span><span class="pln">
        </span><span class="kwd">print</span><span class="pln">
    </span><span class="kwd">print</span></code></pre>

<p>(At first, I tried searching the raw FASTA file source itself, but was puzzled why so few matches compared to the pyparsing version.  Then I realized that some of the matches must cross the line breaks, since the fasta file output is wrapped at n characters.)</p>

<p>So after the first pyparsing pass to extract the gene sequences to match against, this RE-based searcher then took about another 1-1/2 minutes to scan all of the un-textwrapped sequences, to find all of the same 1-mismatch entries that the pyparsing solution did.</p>

    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="http://stackoverflow.com/a/2422902" title="short permalink to this answer" class="short-link" id="link-post-2422902">share</a><span class="lsep">|</span><a href="http://stackoverflow.com/posts/2422902/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2010-03-11 05:59:49Z" class="relativetime">Mar 11 '10 at 5:59</span>
    </div>
    <div class="user-gravatar32">
        <a href="http://stackoverflow.com/users/165216/paul-mcguire"><div><img src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/7da5683418b0e1436cc13f43374773a5" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="http://stackoverflow.com/users/165216/paul-mcguire">Paul McGuire</a><br>
        <span class="reputation-score" title="reputation score 22931" dir="ltr">22.9k</span><span title="3 gold badges"><span class="badge1"></span><span class="badgecount">3</span></span><span title="23 silver badges"><span class="badge2"></span><span class="badgecount">23</span></span><span title="60 bronze badges"><span class="badge3"></span><span class="badgecount">60</span></span>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2422902" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" data-addlink-html="add comment" data-addlink-disabled="true">

    <tr id="comment-2410509" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">The N's are AGCT sequences according to the FASTA format page of wikipedia.</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/254617/justin-peel" title="15627 reputation" class="comment-user">Justin Peel</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment2410509_2422902"><span title="2010-03-11 17:20:58Z" class="relativetime-clean">Mar 11 '10 at 17:20</span></a></span>
				</div>

        </td>
    </tr>
    <tr id="comment-2413837" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">Wow! You get the prize. I like the Hamming also but if am ever going to do more like this I would start with your code. Take a look at my answer to my own question. It is really amazing how fast nexalign is. Found every 1 mismatch from my file against the me49 gondii fasta file in 30 sec.</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/192406/vincent" title="481 reputation" class="comment-user owner">Vincent</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment2413837_2422902"><span title="2010-03-12 01:25:54Z" class="relativetime-clean">Mar 12 '10 at 1:25</span></a></span>
				</div>

        </td>
    </tr>
    <tr id="comment-2415840" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">Don't forget, the raw fasta file lists the sequences in 60-character rows, but the actual gene sequence is the concatenation of many such rows.  A desired match might straddle a newline.</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/165216/paul-mcguire" title="22931 reputation" class="comment-user">Paul McGuire</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment2415840_2422902"><span title="2010-03-12 09:21:41Z" class="relativetime-clean">Mar 12 '10 at 9:21</span></a></span>
				</div>

        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-2422902" data-rep="50" data-anon="true" class="comments-link disabled-link" title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add comment</a>
    </td>
</tr>
    </tbody></table>
</div>

  
<a name="2420528"></a>
<div id="answer-2420528" class="answer" data-answerid="2420528">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="2420528">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">2</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">import</span><span class="pln"> re
</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> seq</span><span class="pun">=</span><span class="str">"AGCCTCCCATGATTGAACAGATCAT"</span><span class="pln">
</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> genome </span><span class="pun">=</span><span class="pln"> </span><span class="str">"CATGGGAGGCTTGCGGAGCCTGAGGGCGGAGCCTGAGGTGGGAGGCTTGCGGAGTGCGGAGCCTGAGCCTGAGGGCGGAGCCTGAGGTGGGAGGCTT..."</span><span class="pln">
</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> seq_re</span><span class="pun">=</span><span class="pln">re</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="str">'|'</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">seq</span><span class="pun">[:</span><span class="pln">i</span><span class="pun">]+</span><span class="str">'.'</span><span class="pun">+</span><span class="pln">seq</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">:]</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">seq</span><span class="pun">))))</span><span class="pln">

</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> seq_re</span><span class="pun">.</span><span class="pln">findall</span><span class="pun">(</span><span class="pln">genome</span><span class="pun">)</span><span class="pln">  </span><span class="com"># list of matches</span><span class="pln">
</span><span class="pun">[]</span><span class="pln">  

</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> seq_re</span><span class="pun">.</span><span class="pln">search</span><span class="pun">(</span><span class="pln">genome</span><span class="pun">)</span><span class="pln"> </span><span class="com"># None if not found, otherwise a match object</span></code></pre>

<p>This one stops a the first match, so may be a bit faster when there are multiple matches</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"found"</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> any</span><span class="pun">(</span><span class="pln">seq_re</span><span class="pun">.</span><span class="pln">finditer</span><span class="pun">(</span><span class="pln">genome</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="str">"not found"</span><span class="pln">
</span><span class="kwd">not</span><span class="pln"> found

</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"found"</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> seq_re</span><span class="pun">.</span><span class="pln">search</span><span class="pun">(</span><span class="pln">genome</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="str">"not found"</span><span class="pln"> 
</span><span class="kwd">not</span><span class="pln"> found

</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> seq</span><span class="pun">=</span><span class="str">"CAT"</span><span class="pln">
</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> seq_re</span><span class="pun">=</span><span class="pln">re</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="str">'|'</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">seq</span><span class="pun">[:</span><span class="pln">i</span><span class="pun">]+</span><span class="str">'.'</span><span class="pun">+</span><span class="pln">seq</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">:]</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">seq</span><span class="pun">))))</span><span class="pln">
</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="kwd">print</span><span class="pln"> </span><span class="str">"found"</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> seq_re</span><span class="pun">.</span><span class="pln">search</span><span class="pun">(</span><span class="pln">genome</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="str">"not found"</span><span class="pln">
found</span></code></pre>

<p>for a genome of length 10,000,000 you are looking at about 2.5 days for a single thread to scan 230,000 sequences, so you may want to split up the task onto a few cores/cpus.</p>

<p>You can always start implementing a more efficient algorithm while this one is running :)</p>

<p>If you should wish to search for single dropped or added elements change the regexp to this</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pun">&gt;&gt;&gt;</span><span class="pln"> seq_re</span><span class="pun">=</span><span class="pln">re</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="str">'|'</span><span class="pun">.</span><span class="pln">join</span><span class="pun">(</span><span class="pln">seq</span><span class="pun">[:</span><span class="pln">i</span><span class="pun">]+</span><span class="str">'.{0,2}'</span><span class="pun">+</span><span class="pln">seq</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">:]</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">seq</span><span class="pun">))))</span></code></pre>

    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="http://stackoverflow.com/a/2420528" title="short permalink to this answer" class="short-link" id="link-post-2420528">share</a><span class="lsep">|</span><a href="http://stackoverflow.com/posts/2420528/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="http://stackoverflow.com/posts/2420528/revisions" title="show all edits to this post">edited <span title="2010-03-10 21:33:24Z" class="relativetime">Mar 10 '10 at 21:33</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        <br>
        
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2010-03-10 20:59:04Z" class="relativetime">Mar 10 '10 at 20:59</span>
    </div>
    <div class="user-gravatar32">
        <a href="http://stackoverflow.com/users/174728/gnibbler"><div><img src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/b6503ff011243d513f9bcc65bbce6d03" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="http://stackoverflow.com/users/174728/gnibbler">gnibbler</a><br>
        <span class="reputation-score" title="reputation score 93885" dir="ltr">93.9k</span><span title="4 gold badges"><span class="badge1"></span><span class="badgecount">4</span></span><span title="101 silver badges"><span class="badge2"></span><span class="badgecount">101</span></span><span title="224 bronze badges"><span class="badge3"></span><span class="badgecount">224</span></span>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2420528" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" data-addlink-html="add comment" data-addlink-disabled="true">

    <tr id="comment-2403109" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">genome is 80mega bases. So I will have lots of time to get a better algorithm. Is there a good/easy way to divide this up from within python?</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/192406/vincent" title="481 reputation" class="comment-user owner">Vincent</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment2403109_2420528"><span title="2010-03-10 21:31:37Z" class="relativetime-clean">Mar 10 '10 at 21:31</span></a></span>
				</div>

        </td>
    </tr>
    <tr id="comment-2403176" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">@Vincent, Probably worth asking this as a separate question. Whichever algorithm you use, it will be worth breaking up the task. How many cores/cpus do you have at your disposal?</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/174728/gnibbler" title="93885 reputation" class="comment-user">gnibbler</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment2403176_2420528"><span title="2010-03-10 21:37:47Z" class="relativetime-clean">Mar 10 '10 at 21:37</span></a></span>
				</div>

        </td>
    </tr>
    <tr id="comment-2403843" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">@Vincent see this question <a href="http://stackoverflow.com/questions/2359253/solving-embarassingly-parallel-problems-using-python-multiprocessing" title="solving embarassingly parallel problems using python multiprocessing">stackoverflow.com/questions/2359253/…</a></span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/174728/gnibbler" title="93885 reputation" class="comment-user">gnibbler</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment2403843_2420528"><span title="2010-03-10 22:55:02Z" class="relativetime-clean">Mar 10 '10 at 22:55</span></a></span>
				</div>

        </td>
    </tr>
    <tr id="comment-2404432" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">I saw a solution using fnmatch.fnmatch() Do you know how that seed might compare?</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/192406/vincent" title="481 reputation" class="comment-user owner">Vincent</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment2404432_2420528"><span title="2010-03-11 00:34:19Z" class="relativetime-clean">Mar 11 '10 at 0:34</span></a></span>
				</div>

        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-2420528" data-rep="50" data-anon="true" class="comments-link disabled-link" title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add comment</a>
    </td>
</tr>
    </tbody></table>
</div>

  
<a name="2420517"></a>
<div id="answer-2420517" class="answer" data-answerid="2420517">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="2420517">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">1</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>This hints of the <a href="http://en.wikipedia.org/wiki/Longest_common_subsequence_problem" rel="nofollow">longest common subsequence problem</a>. The problem with string similarity here is that you need to test against a continuous string of 230000 sequences; so if you are comparing one of your 25 sequences to the continuous string you'll get a very low similarity.</p>

<p>If you compute the longest common subsequence between your 25 sequences and the continuous string, you'll know if it is in the string if the lengths are the same.</p>

    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="http://stackoverflow.com/a/2420517" title="short permalink to this answer" class="short-link" id="link-post-2420517">share</a><span class="lsep">|</span><a href="http://stackoverflow.com/posts/2420517/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="http://stackoverflow.com/posts/2420517/revisions" title="show all edits to this post">edited <span title="2010-03-10 21:02:37Z" class="relativetime">Mar 10 '10 at 21:02</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        <br>
        
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2010-03-10 20:57:35Z" class="relativetime">Mar 10 '10 at 20:57</span>
    </div>
    <div class="user-gravatar32">
        <a href="http://stackoverflow.com/users/135360/pierre-antoine-lafayette"><div><img src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/54229e3b3dbc33c62635ac16f7bcea8d" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="http://stackoverflow.com/users/135360/pierre-antoine-lafayette">Pierre-Antoine LaFayette</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">8,369</span><span title="1 gold badge"><span class="badge1"></span><span class="badgecount">1</span></span><span title="28 silver badges"><span class="badge2"></span><span class="badgecount">28</span></span><span title="39 bronze badges"><span class="badge3"></span><span class="badgecount">39</span></span>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2420517" class="comments dno" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" data-addlink-html="add comment" data-addlink-disabled="true">
					    <tr><td></td><td></td></tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-2420517" data-rep="50" data-anon="true" class="comments-link disabled-link" title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add comment</a>
    </td>
</tr>
    </tbody></table>
</div>

  
<a name="2421460"></a>
<div id="answer-2421460" class="answer" data-answerid="2421460">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="2421460">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">1</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>You could make a <a href="http://en.wikipedia.org/wiki/Trie" rel="nofollow">trie</a> out of all the different sequences that you want to match. Now is the tricky part of making a depth first search function down the trie that allows at most one mismatch.</p>

<p>The advantage of this method is that you are searching through all of the sequences at once. This will save you a lot of comparisons. For instance, when you start at the top node and go down the 'A' branch, you have just saved yourself many thousands of comparisons because have just instantly matched with all sequences that start with 'A'. For a different argument, consider a slice of the genome that matches exactly with a given sequence. If you have a different sequence in your list of sequences that differs only in the last symbol, then using a trie has just saved you 23 comparison operations.</p>

<p>Here is one way of implementing this. Convert 'A','C',T',G' to 0,1,2,3 or a variant of that. Then use tuples of tuples as your structure for your trie. At each node, the first element in your array corresponds with 'A', the second with 'C' and so on. If 'A' is a branch of this node, then there is another tuple of 4 elements as the first item of this node's tuple. If there isn't an 'A' branch, then set the first item to 0. At the bottom of the trie are nodes that have the id of that sequence so that it can be put into the list of matches.</p>

<p>Here are recursive search functions allowing one mismatch for this sort of trie:</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="kwd">def</span><span class="pln"> searchnomismatch</span><span class="pun">(</span><span class="pln">node</span><span class="pun">,</span><span class="pln">genome</span><span class="pun">,</span><span class="pln">i</span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> i </span><span class="pun">==</span><span class="pln"> </span><span class="lit">25</span><span class="pun">:</span><span class="pln">
        addtomatches</span><span class="pun">(</span><span class="pln">node</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">4</span><span class="pun">):</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> node</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]:</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> x </span><span class="pun">==</span><span class="pln"> genome</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln">
                    searchnomismatch</span><span class="pun">(</span><span class="pln">node</span><span class="pun">[</span><span class="pln">x</span><span class="pun">],</span><span class="pln">genome</span><span class="pun">,</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
                </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
                    searchmismatch</span><span class="pun">(</span><span class="pln">node</span><span class="pun">[</span><span class="pln">x</span><span class="pun">],</span><span class="pln">genome</span><span class="pun">,</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">i</span><span class="pun">)</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> searchmismatch</span><span class="pun">(</span><span class="pln">node</span><span class="pun">,</span><span class="pln">genome</span><span class="pun">,</span><span class="pln">i</span><span class="pun">,</span><span class="pln">where</span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> i </span><span class="pun">==</span><span class="pln"> </span><span class="lit">25</span><span class="pun">:</span><span class="pln">
        addtomatches</span><span class="pun">(</span><span class="pln">node</span><span class="pun">,</span><span class="pln">where</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> node</span><span class="pun">[</span><span class="pln">genome</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]:</span><span class="pln">
            searchmismatch</span><span class="pun">(</span><span class="pln">node</span><span class="pun">[</span><span class="pln">genome</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]],</span><span class="pln">genome</span><span class="pun">,</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">where</span><span class="pun">)</span></code></pre>

<p>Here, I start out the search with something like</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">searchnomismatch</span><span class="pun">(</span><span class="pln">trie</span><span class="pun">,</span><span class="pln">genome</span><span class="pun">[</span><span class="pln">ind</span><span class="pun">:</span><span class="pln">ind</span><span class="pun">+</span><span class="lit">25</span><span class="pun">],</span><span class="lit">0</span><span class="pun">)</span></code></pre>

<p>and addtomatches is something similar to</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="kwd">def</span><span class="pln"> addtomatches</span><span class="pun">(</span><span class="pln">id</span><span class="pun">,</span><span class="pln">where</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">):</span><span class="pln">
    matches</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">id</span><span class="pun">,</span><span class="pln">where</span><span class="pun">)</span></code></pre>

<p>where equal to -1 means there wasn't a mismatch. Anyway, I hope that I was clear enough so that you get the picture.</p>

    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="http://stackoverflow.com/a/2421460" title="short permalink to this answer" class="short-link" id="link-post-2421460">share</a><span class="lsep">|</span><a href="http://stackoverflow.com/posts/2421460/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="http://stackoverflow.com/posts/2421460/revisions" title="show all edits to this post">edited <span title="2010-03-11 00:13:39Z" class="relativetime">Mar 11 '10 at 0:13</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        <br>
        
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2010-03-10 23:28:19Z" class="relativetime">Mar 10 '10 at 23:28</span>
    </div>
    <div class="user-gravatar32">
        <a href="http://stackoverflow.com/users/254617/justin-peel"><div><img src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/b8ae9879d7a5fb62f238a019b272d66f" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="http://stackoverflow.com/users/254617/justin-peel">Justin Peel</a><br>
        <span class="reputation-score" title="reputation score 15627" dir="ltr">15.6k</span><span title="2 gold badges"><span class="badge1"></span><span class="badgecount">2</span></span><span title="20 silver badges"><span class="badge2"></span><span class="badgecount">20</span></span><span title="41 bronze badges"><span class="badge3"></span><span class="badgecount">41</span></span>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2421460" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" data-addlink-html="add comment" data-addlink-disabled="true">

    <tr id="comment-2414104" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">Funny, the first thing to occur to me was to make a trie out of all the length-25 substrings of the genome and match each candidate against it in the same way. That'd need way more memory. I think your approach could be optimized still further into a generalization of Aho-Corasick string matching.</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/27024/darius-bacon" title="9078 reputation" class="comment-user">Darius Bacon</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment2414104_2421460"><span title="2010-03-12 02:24:08Z" class="relativetime-clean">Mar 12 '10 at 2:24</span></a></span>
				</div>

        </td>
    </tr>
    <tr id="comment-2414567" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">@Darius Yes, I still think that a trie is a very good approach for this. I don't think that the memory would be too much, especially if a more memory efficient trie like a radix trie is used. I figured out that in the worst case 925 nodes (using a basic trie) will be visited to find all sequences matching a single slice of the genome. The average case is much less than this. That seems pretty fast to me. I'll have to look at the Aho-Corasick algorithm.</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/254617/justin-peel" title="15627 reputation" class="comment-user">Justin Peel</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment2414567_2421460"><span title="2010-03-12 04:11:29Z" class="relativetime-clean">Mar 12 '10 at 4:11</span></a></span>
				</div>

        </td>
    </tr>
    <tr id="comment-2414604" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">Absolutely -- I meant <i>my</i> variant of the answer would have needed way more memory. I did upvote this, it's some silly StackOverflow bug that transfered my vote to some random other answer -- that's happened before. Let's hope it takes, this time.</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/27024/darius-bacon" title="9078 reputation" class="comment-user">Darius Bacon</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment2414604_2421460"><span title="2010-03-12 04:17:10Z" class="relativetime-clean">Mar 12 '10 at 4:17</span></a></span>
				</div>

        </td>
    </tr>
    <tr id="comment-2414621" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">The idea with Aho-Corasick, by the way, is to examine the genome byte by byte without backing up, instead of examining it one 25-byte frame at a time. You compile a state machine ahead of time by walking your tries as if you were matching the genome, only without actually looking at the genome yet -- recording tests and states instead.</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/27024/darius-bacon" title="9078 reputation" class="comment-user">Darius Bacon</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment2414621_2421460"><span title="2010-03-12 04:21:23Z" class="relativetime-clean">Mar 12 '10 at 4:21</span></a></span>
				</div>

        </td>
    </tr>
    <tr id="comment-2414627" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class="comment-score">
                            
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
	<span class="comment-copy">(That'd be equivalent to gnibbler's answer, except Python's built-in regexp implementation apparently doesn't create a state machine, but backtracks instead, so it loses on this problem.)</span>
	–&nbsp;
		<a href="http://stackoverflow.com/users/27024/darius-bacon" title="9078 reputation" class="comment-user">Darius Bacon</a>
	<span class="comment-date" dir="ltr"><a class="comment-link" href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#comment2414627_2421460"><span title="2010-03-12 04:23:41Z" class="relativetime-clean">Mar 12 '10 at 4:23</span></a></span>
				</div>

        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-2421460" data-rep="50" data-anon="true" class="comments-link disabled-link" title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add comment</a>
    </td>
</tr>
    </tbody></table>
</div>

  
<a name="9178839"></a>
<div id="answer-9178839" class="answer" data-answerid="9178839">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="9178839">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">1</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>I tried some of the solutions, but as already written they are slow when dealing with a large amount of sequences (strings).</p>

<p>I came up with using <a href="http://bowtie-bio.sourceforge.net/" rel="nofollow">bowtie</a> and mapping the substring of interest (soi) against a reference file which contains the strings in FASTA format. You can provide the number of allowed mismatches (0..3) and you get back the strings to which the soi mapped given the allowed mismatches. This works well and pretty fast.</p>

    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="http://stackoverflow.com/a/9178839" title="short permalink to this answer" class="short-link" id="link-post-9178839">share</a><span class="lsep">|</span><a href="http://stackoverflow.com/posts/9178839/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info user-hover">
    <div class="user-action-time">
        <a href="http://stackoverflow.com/posts/9178839/revisions" title="show all edits to this post">edited <span title="2012-02-07 15:44:02Z" class="relativetime">Feb 7 '12 at 15:44</span></a>
    </div>
    <div class="user-gravatar32">
        <a href="http://stackoverflow.com/users/894284/matt-fenwick"><div><img src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/5b15ac856b808e329185b1f653805d09" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="http://stackoverflow.com/users/894284/matt-fenwick">Matt Fenwick</a><br>
        <span class="reputation-score" title="reputation score 15766" dir="ltr">15.8k</span><span title="3 gold badges"><span class="badge1"></span><span class="badgecount">3</span></span><span title="33 silver badges"><span class="badge2"></span><span class="badgecount">33</span></span><span title="92 bronze badges"><span class="badge3"></span><span class="badgecount">92</span></span>
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2012-02-07 15:22:14Z" class="relativetime">Feb 7 '12 at 15:22</span>
    </div>
    <div class="user-gravatar32">
        <a href="http://stackoverflow.com/users/1194974/sebastian-boegel"><div><img src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/691517c0a6775b1c0759dba52e5dd8ff" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="http://stackoverflow.com/users/1194974/sebastian-boegel">sebastian.boegel</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">11</span><span title="1 bronze badge"><span class="badge3"></span><span class="badgecount">1</span></span>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-9178839" class="comments dno" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" data-addlink-html="add comment" data-addlink-disabled="true">
					    <tr><td></td><td></td></tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-9178839" data-rep="50" data-anon="true" class="comments-link disabled-link" title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add comment</a>
    </td>
</tr>
    </tbody></table>
</div>

  
<a name="10986521"></a>
<div id="answer-10986521" class="answer" data-answerid="10986521">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="10986521">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">1</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>Python <a href="http://pypi.python.org/pypi/regex/" rel="nofollow">regex</a> library supports fuzzy regular expression matching. One advantage over <a href="http://laurikari.net/tre/" rel="nofollow">TRE</a> is that it allows to find all matches of regular expression in the text (supports overlapping matches as well).</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="kwd">import</span><span class="pln"> regex
m</span><span class="pun">=</span><span class="pln">regex</span><span class="pun">.</span><span class="pln">findall</span><span class="pun">(</span><span class="str">"AA"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CAG"</span><span class="pun">)</span><span class="pln">
</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
m</span><span class="pun">=</span><span class="pln">regex</span><span class="pun">.</span><span class="pln">findall</span><span class="pun">(</span><span class="str">"(AA){e&lt;=1}"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"CAAG"</span><span class="pun">)</span><span class="pln"> </span><span class="com"># means allow up to 1 error</span><span class="pln">
m
</span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="pun">[</span><span class="str">'CA'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'AG'</span><span class="pun">]</span></code></pre>

    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="http://stackoverflow.com/a/10986521" title="short permalink to this answer" class="short-link" id="link-post-10986521">share</a><span class="lsep">|</span><a href="http://stackoverflow.com/posts/10986521/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2012-06-11 19:44:02Z" class="relativetime">Jun 11 '12 at 19:44</span>
    </div>
    <div class="user-gravatar32">
        <a href="http://stackoverflow.com/users/226716/sefatron"><div><img src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/1ab855845db3c234d9ebc0c33f4c4eeb" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="http://stackoverflow.com/users/226716/sefatron">sefatron</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">119</span><span title="1 gold badge"><span class="badge1"></span><span class="badgecount">1</span></span><span title="2 silver badges"><span class="badge2"></span><span class="badgecount">2</span></span><span title="12 bronze badges"><span class="badge3"></span><span class="badgecount">12</span></span>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-10986521" class="comments dno" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" data-addlink-html="add comment" data-addlink-disabled="true">
					    <tr><td></td><td></td></tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-10986521" data-rep="50" data-anon="true" class="comments-link disabled-link" title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add comment</a>
    </td>
</tr>
    </tbody></table>
</div>

  
<a name="2420472"></a>
<div id="answer-2420472" class="answer" data-answerid="2420472">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="2420472">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">0</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>You could use Pythons built in capability to do the search with regular expression matching. </p>

<p>re module in python
<a href="http://docs.python.org/library/re.html" rel="nofollow">http://docs.python.org/library/re.html</a></p>

<p>regular expression primer
<a href="http://www.regular-expressions.info/" rel="nofollow">http://www.regular-expressions.info/</a></p>

    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="http://stackoverflow.com/a/2420472" title="short permalink to this answer" class="short-link" id="link-post-2420472">share</a><span class="lsep">|</span><a href="http://stackoverflow.com/posts/2420472/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2010-03-10 20:49:15Z" class="relativetime">Mar 10 '10 at 20:49</span>
    </div>
    <div class="user-gravatar32">
        <a href="http://stackoverflow.com/users/231528/daniel"><div><img src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/2d0f15382283dc964caaf455eb68a8e3" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="http://stackoverflow.com/users/231528/daniel">Daniel</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">291</span><span title="4 silver badges"><span class="badge2"></span><span class="badgecount">4</span></span><span title="9 bronze badges"><span class="badge3"></span><span class="badgecount">9</span></span>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2420472" class="comments dno" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" data-addlink-html="add comment" data-addlink-disabled="true">
					    <tr><td></td><td></td></tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-2420472" data-rep="50" data-anon="true" class="comments-link disabled-link" title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add comment</a>
    </td>
</tr>
    </tbody></table>
</div>

  
<a name="2923491"></a>
<div id="answer-2923491" class="answer" data-answerid="2923491">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="2923491">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">0</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>I guess this may come a bit late, but there is a tool named PatMaN that does exactly what you want:
<a href="http://bioinf.eva.mpg.de/patman/" rel="nofollow">http://bioinf.eva.mpg.de/patman/</a></p>

    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="http://stackoverflow.com/a/2923491" title="short permalink to this answer" class="short-link" id="link-post-2923491">share</a><span class="lsep">|</span><a href="http://stackoverflow.com/posts/2923491/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2010-05-27 17:46:45Z" class="relativetime">May 27 '10 at 17:46</span>
    </div>
    <div class="user-gravatar32">
        <a href="http://stackoverflow.com/users/352228/cpp1"><div><img src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/8ffc3b4ef32141de1bb3ec6337374978" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="http://stackoverflow.com/users/352228/cpp1">cpp1</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">1</span>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-2923491" class="comments dno" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" data-addlink-html="add comment" data-addlink-disabled="true">
					    <tr><td></td><td></td></tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-2923491" data-rep="50" data-anon="true" class="comments-link disabled-link" title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add comment</a>
    </td>
</tr>
    </tbody></table>
</div>

  
<a name="10985783"></a>
<div id="answer-10985783" class="answer" data-answerid="10985783">
    <table>
        <tbody><tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="10985783">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">0</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>You can use regex matching library TRE, for "approximate matching". It also has bindings for Python, Perl and Haskell.</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="kwd">import</span><span class="pln"> tre

pt </span><span class="pun">=</span><span class="pln"> tre</span><span class="pun">.</span><span class="pln">compile</span><span class="pun">(</span><span class="str">"Don(ald)?( Ervin)? Knuth"</span><span class="pun">,</span><span class="pln"> tre</span><span class="pun">.</span><span class="pln">EXTENDED</span><span class="pun">)</span><span class="pln">
data </span><span class="pun">=</span><span class="pln"> </span><span class="str">"""
In addition to fundamental contributions in several branches of
theoretical computer science, Donnald Erwin Kuth is the creator of
the TeX computer typesetting system, the related METAFONT font
definition language and rendering system, and the Computer Modern
family of typefaces.
"""</span><span class="pln">

fz </span><span class="pun">=</span><span class="pln"> tre</span><span class="pun">.</span><span class="typ">Fuzzyness</span><span class="pun">(</span><span class="pln">maxerr </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">print</span><span class="pln"> fz
m </span><span class="pun">=</span><span class="pln"> pt</span><span class="pun">.</span><span class="pln">search</span><span class="pun">(</span><span class="pln">data</span><span class="pun">,</span><span class="pln"> fz</span><span class="pun">)</span><span class="pln">

</span><span class="kwd">if</span><span class="pln"> m</span><span class="pun">:</span><span class="pln">
    </span><span class="kwd">print</span><span class="pln"> m</span><span class="pun">.</span><span class="pln">groups</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">print</span><span class="pln"> m</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span></code></pre>

<p>which will output</p>

<pre class="lang-py prettyprint prettyprinted" style=""><code><span class="pln">tre</span><span class="pun">.</span><span class="typ">Fuzzyness</span><span class="pun">(</span><span class="pln">delcost</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">inscost</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">maxcost</span><span class="pun">=</span><span class="lit">2147483647</span><span class="pun">,</span><span class="pln">subcost</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> maxdel</span><span class="pun">=</span><span class="lit">2147483647</span><span class="pun">,</span><span class="pln">maxerr</span><span class="pun">=</span><span class="lit">3</span><span class="pun">,</span><span class="pln">maxins</span><span class="pun">=</span><span class="lit">2147483647</span><span class="pun">,</span><span class="pln">maxsub</span><span class="pun">=</span><span class="lit">2147483647</span><span class="pun">)</span><span class="pln">
</span><span class="pun">((</span><span class="lit">95</span><span class="pun">,</span><span class="pln"> </span><span class="lit">113</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">99</span><span class="pun">,</span><span class="pln"> </span><span class="lit">108</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="lit">102</span><span class="pun">,</span><span class="pln"> </span><span class="lit">108</span><span class="pun">))</span><span class="pln">
</span><span class="typ">Donnald</span><span class="pln"> </span><span class="typ">Erwin</span><span class="pln"> </span><span class="typ">Kuth</span></code></pre>

<p><a href="http://en.wikipedia.org/wiki/TRE_%28computing%29" rel="nofollow">http://en.wikipedia.org/wiki/TRE_%28computing%29</a></p>

<p><a href="http://laurikari.net/tre/" rel="nofollow">http://laurikari.net/tre/</a></p>

    </div>
    <table class="fw">
    <tbody><tr>
    <td class="vt">
<div class="post-menu"><a href="http://stackoverflow.com/a/10985783" title="short permalink to this answer" class="short-link" id="link-post-10985783">share</a><span class="lsep">|</span><a href="http://stackoverflow.com/posts/10985783/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2012-06-11 18:45:12Z" class="relativetime">Jun 11 '12 at 18:45</span>
    </div>
    <div class="user-gravatar32">
        <a href="http://stackoverflow.com/users/226716/sefatron"><div><img src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/1ab855845db3c234d9ebc0c33f4c4eeb" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="http://stackoverflow.com/users/226716/sefatron">sefatron</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">119</span><span title="1 gold badge"><span class="badge1"></span><span class="badgecount">1</span></span><span title="2 silver badges"><span class="badge2"></span><span class="badgecount">2</span></span><span title="12 bronze badges"><span class="badge3"></span><span class="badgecount">12</span></span>
    </div>
</div>
    </td>
    </tr>
    </tbody></table>
</td>
        </tr>

<tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-10985783" class="comments dno" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" data-addlink-html="add comment" data-addlink-disabled="true">
					    <tr><td></td><td></td></tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-10985783" data-rep="50" data-anon="true" class="comments-link disabled-link" title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”.">add comment</a>
    </td>
</tr>
    </tbody></table>
</div>
									<a name="new-answer"></a>
						<form id="post-form" action="http://stackoverflow.com/questions/2420412/answer/submit" method="post" class="post-form">
							<input type="hidden" id="post-id" value="2420412">
							<h2 class="space">Your Answer</h2>



    

<script type="text/javascript">
    StackExchange.ready(function() {
        initTagRenderer("".split(" "), "".split(" "));
         
        prepareEditor({
            heartbeatType: 'answer',
            bindNavPrevention: true,
            postfix: "",
            onDemand: true,
            discardSelector: ".discard-answer"
            ,immediatelyShowMarkdownHelp:true
        });
        

    });  
</script>


<div id="post-editor" class="post-editor">

    <div style="position: relative;">     
        <div class="wmd-container">
            <div id="wmd-button-bar" class="wmd-button-bar"><ul id="wmd-button-row" class="wmd-button-row"><li id="wmd-bold-button" class="wmd-button" style="left: 0px;"><span style="background-position: 0px -20px;"></span></li><li id="wmd-italic-button" class="wmd-button" style="left: 25px;"><span style="background-position: -20px -20px;"></span></li><li id="wmd-spacer1" class="wmd-spacer" style="left: 50px;"><span style="background-position: -40px -20px;"></span></li><li id="wmd-link-button" class="wmd-button" style="left: 75px;"><span style="background-position: -40px -20px;"></span></li><li id="wmd-quote-button" class="wmd-button" style="left: 100px;"><span style="background-position: -60px -20px;"></span></li><li id="wmd-code-button" class="wmd-button" style="left: 125px;"><span style="background-position: -80px -20px;"></span></li><li id="wmd-image-button" class="wmd-button" style="left: 150px;"><span style="background-position: -100px -20px;"></span></li><li id="wmd-spacer2" class="wmd-spacer" style="left: 175px;"><span style="background-position: -120px -20px;"></span></li><li id="wmd-olist-button" class="wmd-button" style="left: 200px;"><span style="background-position: -120px -20px;"></span></li><li id="wmd-ulist-button" class="wmd-button" style="left: 225px;"><span style="background-position: -140px -20px;"></span></li><li id="wmd-heading-button" class="wmd-button" style="left: 250px;"><span style="background-position: -160px -20px;"></span></li><li id="wmd-hr-button" class="wmd-button" style="left: 275px;"><span style="background-position: -180px -20px;"></span></li><li id="wmd-spacer3" class="wmd-spacer" style="left: 300px;"><span style="background-position: -200px -20px;"></span></li><li id="wmd-undo-button" class="wmd-button" style="left: 325px;"><span style="background-position: -200px -20px;"></span></li><li id="wmd-redo-button" class="wmd-button" style="left: 350px;"><span style="background-position: -220px -20px;"></span></li></ul></div>
            <textarea id="wmd-input" class="wmd-input" name="post-text" cols="92" rows="15" tabindex="101" data-min-length=""></textarea>
        </div>
    </div>

    <div class="fl" style="margin-top: 8px; height:24px;">&nbsp;</div>
    <div id="draft-saved" class="draft-saved community-option fl" style="margin-top: 8px; height:24px; display:none;">draft saved</div>

    <div id="draft-discarded" class="draft-discarded community-option fl" style="margin-top: 8px; height:24px; display:none;">draft discarded</div>



    <div id="wmd-preview" class="wmd-preview"></div>
    <div></div>
    <div class="edit-block">
        <input id="fkey" name="fkey" type="hidden" value="5be5aa6d86002f77879c88035743a3e3">
        <input id="author" name="author" type="text">
    </div>
</div>
							<div style="position: relative;">
								
            <div class="form-item new-post-login">
        
                <div class="new-login-form">
                    <div class="new-login-left">
                        <h3>Sign up or <a id="login-link" href="http://stackoverflow.com/users/login?returnurl=%2fquestions%2f2420412%2fsearch-for-string-allowing-for-one-mismatch-in-any-location-of-the-string%23new-answer">log in</a></h3>
                        <script type="text/javascript">
                            StackExchange.ready(function () {
                                StackExchange.helpers.onClickDraftSave('#login-link');
                            });
                        </script>
                        <div class="preferred-login google-login">
                            <p><span class="icon"></span><span>Sign up using Google</span></p>
                        </div>
                        <div class="preferred-login facebook-login">
                            <p><span class="icon"></span><span>Sign up using Facebook</span></p>
                        </div>
                        <div class="preferred-login stackexchange-login">
                            <p><span class="icon"></span><span>Sign up using Stack Exchange</span></p>
                        </div>
                    </div>
                    <input type="hidden" name="manual-openid" class="manual-openid">
                    <input type="hidden" name="use-facebook" class="use-facebook" value="false">
                    <input type="button" class="submit-openid" value="Submit" style="display:none">
                    <div class="new-login-right">
                                <h3>Post as a guest</h3>
    <div class="form-item">
        <table>
        <tbody><tr>
                    <script type="text/javascript">
                StackExchange.ready(function () {
                    StackExchange.helpers.bindHelpOverlayEvents($('.vm input'));
                });
            </script>
            <td class="vm">
                <div>
                    <label for="display-name">Name</label>
                    <input id="display-name" name="display-name" type="text" size="30" maxlength="30" value="" tabindex="105">
                </div>
                <div>
                    <label for="m-address">Email</label>
                    <input id="m-address" name="m-address" type="text" size="30" maxlength="100" value="" tabindex="106">
                    <span class="edit-field-overlay">required, but not shown</span>
                </div>
            </td>
        </tr>
        </tbody></table>
    </div>

                    </div>
                </div>
            </div>
            <script type="text/javascript">
                StackExchange.ready(
                    function () {
                        StackExchange.openid.initPostLogin('.new-post-login', '%2fquestions%2f2420412%2fsearch-for-string-allowing-for-one-mismatch-in-any-location-of-the-string%23new-answer');
                    }
                );
            </script>
            <noscript>
                        &lt;h3&gt;Post as a guest&lt;/h3&gt;
    &lt;div class="form-item"&gt;
        &lt;table&gt;
        &lt;tr&gt;
                    &lt;script type="text/javascript"&gt;
                StackExchange.ready(function () {
                    StackExchange.helpers.bindHelpOverlayEvents($('.vm input'));
                });
            &lt;/script&gt;
            &lt;td class="vm"&gt;
                &lt;div&gt;
                    &lt;label for="display-name"&gt;Name&lt;/label&gt;
                    &lt;input id="display-name" name="display-name" type="text" size="30" maxlength="30" value="" tabindex="105"&gt;
                &lt;/div&gt;
                &lt;div&gt;
                    &lt;label for="m-address"&gt;Email&lt;/label&gt;
                    &lt;input id="m-address" name="m-address" type="text" size="30" maxlength="100" value="" tabindex="106"&gt;
                    &lt;span class="edit-field-overlay"&gt;required, but not shown&lt;/span&gt;
                &lt;/div&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;/table&gt;
    &lt;/div&gt;

            </noscript>
							</div>
           
															<div class="form-submit cbt">
									<input id="submit-button" type="submit" value="Post Your Answer" tabindex="110">
									<a href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#" class="discard-answer dno">discard</a>

<p class="privacy-policy-agreement">
By posting your answer, you agree to the <a href="http://stackexchange.com/legal/privacy-policy" target="_blank">privacy policy</a> and <a href="http://stackexchange.com/legal/terms-of-service" target="_blank">terms of service</a>.</p>
<input type="hidden" name="legalLinksShown" value="1">								</div>
						</form>



						<h2 class="bottom-notice">
Not the answer you're looking for?							Browse other questions tagged <a href="http://stackoverflow.com/questions/tagged/python" class="post-tag" title="show questions tagged &#39;python&#39;" rel="tag">python</a> <a href="http://stackoverflow.com/questions/tagged/string" class="post-tag" title="show questions tagged &#39;string&#39;" rel="tag">string</a> <a href="http://stackoverflow.com/questions/tagged/pattern-matching" class="post-tag" title="show questions tagged &#39;pattern-matching&#39;" rel="tag">pattern-matching</a> <a href="http://stackoverflow.com/questions/tagged/string-matching" class="post-tag" title="show questions tagged &#39;string-matching&#39;" rel="tag">string-matching</a> <a href="http://stackoverflow.com/questions/tagged/dna-sequence" class="post-tag" title="show questions tagged &#39;dna-sequence&#39;" rel="tag">dna-sequence</a>  or <a href="http://stackoverflow.com/questions/ask">ask your own question</a>.						</h2>
			</div>
		</div>
				<div id="sidebar" class="show-votes">
							<div class="module question-stats">
					<p class="label-key">tagged</p>
					<div class="tagged"><a href="http://stackoverflow.com/questions/tagged/python" class="post-tag js-gps-track" title="show questions tagged &#39;python&#39;" rel="tag">python</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">261489</span></span><br>
<a href="http://stackoverflow.com/questions/tagged/string" class="post-tag js-gps-track" title="show questions tagged &#39;string&#39;" rel="tag">string</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">51983</span></span><br>
<a href="http://stackoverflow.com/questions/tagged/pattern-matching" class="post-tag js-gps-track" title="show questions tagged &#39;pattern-matching&#39;" rel="tag">pattern-matching</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">2745</span></span><br>
<a href="http://stackoverflow.com/questions/tagged/string-matching" class="post-tag js-gps-track" title="show questions tagged &#39;string-matching&#39;" rel="tag">string-matching</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">578</span></span><br>
<a href="http://stackoverflow.com/questions/tagged/dna-sequence" class="post-tag js-gps-track" title="show questions tagged &#39;dna-sequence&#39;" rel="tag">dna-sequence</a>&nbsp;<span class="item-multiplier"><span class="item-multiplier-x">×</span>&nbsp;<span class="item-multiplier-count">81</span></span><br>
</div>
					<table id="qinfo">
						<tbody><tr>
							<td>
								<p class="label-key">asked</p>
							</td>
							<td style="padding-left: 10px">
								<p class="label-key" title="2010-03-10 20:42:30Z"><b>3 years ago</b></p>
							</td>
						</tr>
						<tr>
							<td>
								<p class="label-key">viewed</p>
							</td>

							<td style="padding-left: 10px">
								<p class="label-key">
									<b>4653 times</b>
								</p>
							</td>
						</tr>
							<tr>
								<td>
									<p class="label-key">active</p>
								</td>
								<td style="padding-left: 10px">
									<p class="label-key"><b><a href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string?lastactivity" class="lastactivity-link" title="2013-05-27 15:58:57Z">8 months ago</a></b></p>
								</td>
							</tr>
					</tbody></table>
				</div>
						
			<script type="text/javascript">
                var ados = ados || {};ados.run = ados.run || [];
                ados.run.push(function() { ados_add_placement(22,8277,"adzerk857721947",17).setZone(45) ; });                    
            </script>
            <div class="everyonelovesstackoverflow adzerk-vote" id="adzerk857721947"><a href="http://engine.adzerk.net/r?e=eyJhdiI6NDE0LCJhdCI6MTcsImNtIjo4NDcsImNoIjoxMTc4LCJjciI6OTMzMywiZGkiOiJkNDU0Yzg5NzM3MTA0MzBlYjA2MDE2YjY4MmIyNTY4ZCIsImRtIjoxLCJmYyI6MTQ4NDMsImZsIjoyNDQ0LCJrdyI6InB5dGhvbixzdHJpbmcscGF0dGVybi1tYXRjaGluZyxzdHJpbmctbWF0Y2hpbmcsZG5hLXNlcXVlbmNlIiwibnciOjIyLCJwYyI6MCwicHIiOjE1NjgsInJ0IjoxLCJyZiI6Imh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vIiwic3QiOjgyNzcsInpuIjo0NSwidHMiOjEzOTA4MDA1MDcyNTQsInVyIjoiaHR0cDovL2NhcmVlcnMuc3RhY2tvdmVyZmxvdy5jb20vIn0&s=29ivWrcwUeewcGIVugXgD6x8Gao" rel="nofollow" target="_blank" title=""><img src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/12f0cc69cd9742faa9c8ee0f7b0d210e.jpg" title="" alt="" border="0" width="220" height="250"></a><div class="adzerk-vote-controls" style="display:none;"><div class="adzerk-vote-option adzerk-vote-up"><div class="adzerk-vote-icon"></div></div><div class="adzerk-vote-option adzerk-vote-down"><div class="adzerk-vote-icon"></div></div></div><div class="adzerk-vote-survey" style="display:none;"><form><span>No problem. We won't show you that ad again. Why didn't you like it?</span><ul><li><label><input type="radio" value="12" name="downvoteReason">Uninteresting</label></li><li><label><input type="radio" value="13" name="downvoteReason">Misleading</label></li><li><label><input type="radio" value="14" name="downvoteReason">Offensive</label></li><li><label><input type="radio" value="15" name="downvoteReason">Repetitive</label></li></ul><a href="http://stackoverflow.com/questions/2420412/search-for-string-allowing-for-one-mismatch-in-any-location-of-the-string#" class="adzerk-vote-cancel">Oops! I didn't mean to do this.</a></form></div><img height="0px" width="0px" border="0" src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/i(2).gif"></div>  
    <div id="hireme"> <a href="http://careers.stackoverflow.com/jobs?a=144" class="top" target="_blank"></a> <ul class="jobs"> <li> <a href="http://careers.stackoverflow.com/jobs/47333/senior-web-hosting-engineer-filmtrack-inc?a=VJ7l9pIc" target="_blank" title="Senior Web Hosting Engineer at FilmTrack. Click to learn more."> Senior Web Hosting Engineer<br> <span class="company">FilmTrack</span> <span class="location">Studio City, CA</span> </a> </li> <li> <a href="http://careers.stackoverflow.com/jobs/46090/net-developer-logix-federal-credit-union?a=Ud7YfMQ0" target="_blank" title=".net Developer at Logix Federal Credit Union. Click to learn more."> .net Developer<br> <span class="company">Logix Federal Credit Union</span> <span class="location">Burbank, CA</span> </a> </li> <li> <a href="http://careers.stackoverflow.com/jobs/46118/senior-ruby-on-rails-developer-doublebeam?a=UffeSEhO" target="_blank" title="Senior Ruby on Rails Developer at DoubleBeam. Click to learn more."> Senior Ruby on Rails Developer<br> <span class="company">DoubleBeam</span> <span class="location">Pasadena, CA</span> </a> </li> <li class="city"><a href="http://careers.stackoverflow.com/jobs/location/alhambra%2c%20ca%2c%20united%20states?a=x0VW">More jobs near Alhambra...</a></li> </ul> <img alt="" class="impression" src="./python - Search for string allowing for one mismatch in any location of the string - Stack Overflow_files/VJ7l9pIc-Ud7YfMQ0-UffeSEhO-144-x0VW" style="display:none"></div>
			  
    
            <div class="module sidebar-linked">
	<h4 id="h-linked">Linked</h4>
	<div class="linked" data-tracker="lq=1">
<div class="spacer">
	<a href="http://stackoverflow.com/q/9370827?lq=1" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">0</div>
	</a>
	<a href="http://stackoverflow.com/questions/9370827/1-mismatch-regular-expression?lq=1" class="question-hyperlink">1-mismatch regular expression</a>
</div><div class="spacer">
	<a href="http://stackoverflow.com/q/2359253?lq=1" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">36</div>
	</a>
	<a href="http://stackoverflow.com/questions/2359253/solving-embarassingly-parallel-problems-using-python-multiprocessing?lq=1" class="question-hyperlink">Solving embarassingly parallel problems using Python multiprocessing</a>
</div><div class="spacer">
	<a href="http://stackoverflow.com/q/1672782?lq=1" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">7</div>
	</a>
	<a href="http://stackoverflow.com/questions/1672782/fastest-way-to-find-mismatch-positions-between-two-strings-of-the-same-length?lq=1" class="question-hyperlink">Fastest Way To Find Mismatch Positions Between Two Strings of the Same Length</a>
</div><div class="spacer">
	<a href="http://stackoverflow.com/q/8509259?lq=1" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes  default">0</div>
	</a>
	<a href="http://stackoverflow.com/questions/8509259/multiple-mismatches-in-dna-search-sequence-regex?lq=1" class="question-hyperlink">Multiple mismatches in DNA search sequence regex</a>
</div><div class="spacer">
	<a href="http://stackoverflow.com/q/20128708?lq=1" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes  default">1</div>
	</a>
	<a href="http://stackoverflow.com/questions/20128708/is-it-possible-to-allow-mismatches-in-kmp-algorithm?lq=1" class="question-hyperlink">Is it possible to allow mismatches in KMP algorithm?</a>
</div>			</div>
</div>

				<div class="module sidebar-related">
					<h4 id="h-related">Related</h4>
                    <div class="related js-gps-related-questions" data-tracker="rq=1">
                        <div class="spacer js-gps-track">
<a href="http://stackoverflow.com/q/1177278?rq=1" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">1
    </div>
</a><a href="http://stackoverflow.com/questions/1177278/string-matching-techniques-by-converting-to-number?rq=1" class="question-hyperlink">String matching technique(s) by converting to number?</a>
</div>
<div class="spacer js-gps-track">
<a href="http://stackoverflow.com/q/2768628?rq=1" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">3
    </div>
</a><a href="http://stackoverflow.com/questions/2768628/iterating-through-string-word-at-a-time-in-python?rq=1" class="question-hyperlink">Iterating through String word at a time in Python</a>
</div>
<div class="spacer js-gps-track">
<a href="http://stackoverflow.com/q/8509259?rq=1" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">0
    </div>
</a><a href="http://stackoverflow.com/questions/8509259/multiple-mismatches-in-dna-search-sequence-regex?rq=1" class="question-hyperlink">Multiple mismatches in DNA search sequence regex</a>
</div>
<div class="spacer js-gps-track">
<a href="http://stackoverflow.com/q/9084857?rq=1" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">1
    </div>
</a><a href="http://stackoverflow.com/questions/9084857/string-matching-implementation?rq=1" class="question-hyperlink">String matching implementation</a>
</div>
<div class="spacer js-gps-track">
<a href="http://stackoverflow.com/q/10121088?rq=1" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">6
    </div>
</a><a href="http://stackoverflow.com/questions/10121088/string-pattern-matching-with-one-or-zero-mismatch?rq=1" class="question-hyperlink">String pattern matching with one or zero mismatch</a>
</div>
<div class="spacer js-gps-track">
<a href="http://stackoverflow.com/q/11013196?rq=1" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">2
    </div>
</a><a href="http://stackoverflow.com/questions/11013196/finding-locations-where-two-strings-differ?rq=1" class="question-hyperlink">Finding locations where two strings differ</a>
</div>
<div class="spacer js-gps-track">
<a href="http://stackoverflow.com/q/11375523?rq=1" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">0
    </div>
</a><a href="http://stackoverflow.com/questions/11375523/lua-extract-a-string-using-patterns?rq=1" class="question-hyperlink">Lua - extract a string using patterns</a>
</div>
<div class="spacer js-gps-track">
<a href="http://stackoverflow.com/q/16068189?rq=1" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">0
    </div>
</a><a href="http://stackoverflow.com/questions/16068189/find-a-dna-barcode-with-mismatches-in-sequence?rq=1" class="question-hyperlink">find a DNA barcode with mismatches in sequence</a>
</div>
<div class="spacer js-gps-track">
<a href="http://stackoverflow.com/q/19637646?rq=1" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">3
    </div>
</a><a href="http://stackoverflow.com/questions/19637646/get-close-string-matches-considering-deletion-python?rq=1" class="question-hyperlink">Get close string matches considering deletion - python</a>
</div>
<div class="spacer js-gps-track">
<a href="http://stackoverflow.com/q/20128708?rq=1" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">1
    </div>
</a><a href="http://stackoverflow.com/questions/20128708/is-it-possible-to-allow-mismatches-in-kmp-algorithm?rq=1" class="question-hyperlink">Is it possible to allow mismatches in KMP algorithm?</a>
</div>

                    </div>
				</div>
            
<div id="hot-network-questions" class="module">
    <h4>
        <a href="http://stackexchange.com/questions?tab=hot" class="js-gps-track" data-gps-track="posts_hot_network.click({ item_type:1, location:11 })">
            Hot Network Questions
        </a>
    </h4>
    <ul>
            <li>
                <div class="favicon favicon-tex" title="TeX - LaTeX Stack Exchange"></div><a href="http://tex.stackexchange.com/questions/156113/is-there-any-tool-available-to-latex-to-search-for-files-with-wildcards" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:85 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Is there any tool available to LaTeX to search for files with wildcards?
                </a>

            </li>
            <li>
                <div class="favicon favicon-physics" title="Physics Stack Exchange"></div><a href="http://physics.stackexchange.com/questions/95366/why-does-stephen-hawking-say-black-holes-dont-exist" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:151 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why does Stephen Hawking say black holes don't exist?
                </a>

            </li>
            <li>
                <div class="favicon favicon-stackoverflow" title="Stack Overflow"></div><a href="http://stackoverflow.com/questions/21369131/when-should-i-use-decltypex-instead-of-auto-to-declare-the-type-of-a-variable" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:1 }); posts_hot_network.click({ item_type:2, location:11 })">
                    When should I use decltype(x) instead of auto to declare the type of a variable?
                </a>

            </li>
            <li>
                <div class="favicon favicon-electronics" title="Electrical Engineering Stack Exchange"></div><a href="http://electronics.stackexchange.com/questions/97738/what-exactly-fries-the-chip-when-you-invert-power-supply" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:135 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What exactly fries the chip when you invert power supply?
                </a>

            </li>
            <li>
                <div class="favicon favicon-superuser" title="Super User"></div><a href="http://superuser.com/questions/707254/where-is-the-bios-stored" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:3 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Where is the BIOS stored?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-japanese" title="Japanese Language Stack Exchange"></div><a href="http://japanese.stackexchange.com/questions/14299/how-accurately-can-%e4%bd%bf%e3%81%84-be-translated-as-angel" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:257 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How accurately can 使い be translated as "angel"?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-unix" title="Unix &amp; Linux Stack Exchange"></div><a href="http://unix.stackexchange.com/questions/111049/how-to-find-out-how-many-bits-has-a-file-in-one-command" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:106 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How to find out how many bits has a file in one command?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-scifi" title="Science Fiction &amp; Fantasy Stack Exchange"></div><a href="http://scifi.stackexchange.com/questions/48945/do-lord-of-the-rings-or-the-silmarillion-pass-the-bechdel-test" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:186 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Do Lord of the Rings or The Silmarillion pass the Bechdel test?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-ux" title="User Experience Stack Exchange"></div><a href="http://ux.stackexchange.com/questions/50893/do-we-exit-quit-or-close-an-application" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:102 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Do we “exit”, “quit” or "close" an application?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-codereview" title="Code Review Stack Exchange"></div><a href="http://codereview.stackexchange.com/questions/40101/java-method-levels-of-abstraction" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:196 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Java method - levels of abstraction
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-rpg" title="Role-playing Games Stack Exchange"></div><a href="http://rpg.stackexchange.com/questions/31982/how-far-can-characters-see" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:122 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How far can characters see?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-tex" title="TeX - LaTeX Stack Exchange"></div><a href="http://tex.stackexchange.com/questions/156096/placing-tikz-drawings-in-a-minipage-side-by-side" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:85 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Placing TikZ drawings in a minipage side by side
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-math" title="Mathematics Stack Exchange"></div><a href="http://math.stackexchange.com/questions/649408/is-computer-science-a-branch-of-mathematics" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:69 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Is computer science a branch of mathematics?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-codegolf" title="Programming Puzzles &amp; Code Golf Stack Exchange"></div><a href="http://codegolf.stackexchange.com/questions/18986/draw-the-olympic-games-logo" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:200 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Draw the Olympic Games logo
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-stats" title="Cross Validated"></div><a href="http://stats.stackexchange.com/questions/83136/is-facebook-coming-to-an-end" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:65 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Is Facebook coming to an end?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-english" title="English Language &amp; Usage Stack Exchange"></div><a href="http://english.stackexchange.com/questions/148096/what-does-spam-in-a-can-mean" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:97 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What does "spam in a can" mean?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-crypto" title="Cryptography Stack Exchange"></div><a href="http://crypto.stackexchange.com/questions/13140/how-long-will-my-encryption-remain-private" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:281 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How long will my encryption remain private?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-security" title="Information Security Stack Exchange"></div><a href="http://security.stackexchange.com/questions/49234/why-are-chips-safer-than-magnetic-stripes" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:162 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why are chips safer than magnetic stripes?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-mathoverflow" title="MathOverflow"></div><a href="http://mathoverflow.net/questions/155789/is-the-hodge-conjecture-birationally-invariant" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:504 }); posts_hot_network.click({ item_type:2, location:11 })">
                    is the Hodge conjecture birationally invariant?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-japanese" title="Japanese Language Stack Exchange"></div><a href="http://japanese.stackexchange.com/questions/14303/what-is-the-radical-which-is-written-by-two-dots-on-the-top-of-a-kanji" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:257 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What is the radical which is written by two dots on the top of a Kanji?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-math" title="Mathematics Stack Exchange"></div><a href="http://math.stackexchange.com/questions/652550/a-function-takes-every-function-value-twice-proof-it-is-not-continuous" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:69 }); posts_hot_network.click({ item_type:2, location:11 })">
                    A function takes every function value twice - proof it is not continuous
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-security" title="Information Security Stack Exchange"></div><a href="http://security.stackexchange.com/questions/49380/does-gibsons-fingerprinting-service-add-much-additional-security" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:162 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Does Gibson's fingerprinting service add much additional security?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-english" title="English Language &amp; Usage Stack Exchange"></div><a href="http://english.stackexchange.com/questions/148153/why-are-they-called-hudson-bay-and-bay-of-biscay-why-mediterranean-sea-and-sea" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:97 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why are they called Hudson Bay and Bay of Biscay? Why Mediterranean Sea and Sea of Japan?
                </a>

            </li>
            <li class="dno js-hidden" style="display: list-item;">
                <div class="favicon favicon-askubuntu" title="Ask Ubuntu"></div><a href="http://askubuntu.com/questions/411147/what-is-the-relationship-between-unity-gnome-gnome-3-compiz-metacity-and-li" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:89 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What is the relationship between Unity, Gnome, Gnome 3, Compiz, Metacity, and LightDM?
                </a>

            </li>
    </ul>

        
        <script>
            StackExchange.ready(function () {
                var $div = $('#hot-network-questions'),
                    $more = $div.find('.js-show-more'),
                    $hidden = $div.find('.js-hidden');

                $more.click(function () {
                    $hidden.show();
                    $more.remove();
                    return false;
                });

            
                var mHeight = $('#mainbar').height(),
                    sHeight = $('#sidebar').height() + 550;

                if (mHeight > sHeight) {
                    $hidden.each(function() {
                        sHeight += $(this).show().height();
                        return mHeight > sHeight;
                    });

                    if ($hidden.filter(':hidden').length == 0) {
                        $more.remove();
                    }
                }
            
            
            });
        </script>
</div>
		</div>
	
<div id="feed-link">
    <div id="feed-link-text"><a href="http://stackoverflow.com/feeds/question/2420412" title="feed of this question and its answers"><span class="feed-icon"></span>question feed</a></div>
</div>
	<script type="text/javascript">
StackExchange.ready(function(){$.get('/posts/2420412/ivc/5459');});
</script>
<noscript>
    &lt;div&gt;&lt;img src="/posts/2420412/ivc/5459" class="dno" alt="" width="0" height="0"&gt;&lt;/div&gt;
</noscript><div style="display:none" id="prettify-lang">lang-py</div></div>


        </div>
    </div>
    <div id="footer" class="categories">
        <div class="footerwrap">
            <div id="footer-menu">
                <div class="top-footer-links">
                        <a href="http://stackoverflow.com/about">about</a>
                    <a href="http://stackoverflow.com/help">help</a>
                        <a href="http://stackoverflow.com/help/badges">badges</a>
                    <a href="http://blog.stackexchange.com/?blb=1">blog</a>
                        <a href="http://chat.stackoverflow.com/">chat</a>
                    <a href="http://data.stackexchange.com/">data</a>
                    <a href="http://stackexchange.com/legal">legal</a>
                    <a href="http://stackexchange.com/legal/privacy-policy">privacy policy</a>
                    <a href="http://stackexchange.com/about/hiring">jobs</a>
                    <a href="http://engine.adzerk.net/r?e=eyJhdiI6NDE0LCJhdCI6MjAsImNtIjo5NTQsImNoIjoxMTc4LCJjciI6Mjc3NiwiZG0iOjQsImZjIjoyODYyLCJmbCI6Mjc1MSwibnciOjIyLCJydiI6MCwicHIiOjExNSwic3QiOjAsInVyIjoiaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2Fib3V0L2NvbnRhY3QiLCJyZSI6MX0&s=hRods5B22XvRBwWIwtIMekcyNF8">advertising info</a>

                    <a onclick="StackExchange.switchMobile(&quot;on&quot;)">mobile</a>
                    <b><a href="http://stackoverflow.com/contact">contact us</a></b>
                        <b><a href="http://meta.stackoverflow.com/">feedback</a></b>
                    
                </div>
                <div id="footer-sites">
                    <table>
    <tbody><tr>
            <th colspan="3">
                Technology
            </th>
            <th>
                Life / Arts
            </th>
            <th>
                Culture / Recreation
            </th>
            <th>
                Science
            </th>
            <th>
                Other
            </th>
    </tr>
    <tr>
            <td>
                <ol>
                        <li><a href="http://stackoverflow.com/" title="professional and enthusiast programmers">Stack Overflow</a></li>
                        <li><a href="http://serverfault.com/" title="professional system and network administrators">Server Fault</a></li>
                        <li><a href="http://superuser.com/" title="computer enthusiasts and power users">Super User</a></li>
                        <li><a href="http://webapps.stackexchange.com/" title="power users of web applications">Web Applications</a></li>
                        <li><a href="http://askubuntu.com/" title="Ubuntu users and developers">Ask Ubuntu</a></li>
                        <li><a href="http://webmasters.stackexchange.com/" title="pro webmasters">Webmasters</a></li>
                        <li><a href="http://gamedev.stackexchange.com/" title="professional and independent game developers">Game Development</a></li>
                        <li><a href="http://tex.stackexchange.com/" title="users of TeX, LaTeX, ConTeXt, and related typesetting systems">TeX - LaTeX</a></li>
                            </ol></td><td><ol>
                        <li><a href="http://programmers.stackexchange.com/" title="professional programmers interested in conceptual questions about software development">Programmers</a></li>
                        <li><a href="http://unix.stackexchange.com/" title="users of Linux, FreeBSD and other Un*x-like operating systems.">Unix &amp; Linux</a></li>
                        <li><a href="http://apple.stackexchange.com/" title="power users of Apple hardware and software">Ask Different (Apple)</a></li>
                        <li><a href="http://wordpress.stackexchange.com/" title="WordPress developers and administrators">WordPress Answers</a></li>
                        <li><a href="http://gis.stackexchange.com/" title="cartographers, geographers and GIS professionals">Geographic Information Systems</a></li>
                        <li><a href="http://electronics.stackexchange.com/" title="electronics and electrical engineering professionals, students, and enthusiasts">Electrical Engineering</a></li>
                        <li><a href="http://android.stackexchange.com/" title="enthusiasts and power users of the Android operating system">Android Enthusiasts</a></li>
                        <li><a href="http://security.stackexchange.com/" title="Information security professionals">Information Security</a></li>
                            </ol></td><td><ol>
                        <li><a href="http://dba.stackexchange.com/" title="database professionals who wish to improve their database skills and learn from others in the community">Database Administrators</a></li>
                        <li><a href="http://drupal.stackexchange.com/" title="Drupal developers and administrators">Drupal Answers</a></li>
                        <li><a href="http://sharepoint.stackexchange.com/" title="SharePoint enthusiasts">SharePoint</a></li>
                        <li><a href="http://ux.stackexchange.com/" title="user experience researchers and experts">User Experience</a></li>
                        <li><a href="http://mathematica.stackexchange.com/" title="users of Mathematica">Mathematica</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#technology" class="more">
                                more (14)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://photo.stackexchange.com/" title="professional, enthusiast and amateur photographers">Photography</a></li>
                        <li><a href="http://scifi.stackexchange.com/" title="science fiction and fantasy enthusiasts">Science Fiction &amp; Fantasy</a></li>
                        <li><a href="http://cooking.stackexchange.com/" title="professional and amateur chefs">Seasoned Advice (cooking)</a></li>
                        <li><a href="http://diy.stackexchange.com/" title="contractors and serious DIYers">Home Improvement</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#lifearts" class="more">
                                more (13)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://english.stackexchange.com/" title="linguists, etymologists, and serious English language enthusiasts">English Language &amp; Usage</a></li>
                        <li><a href="http://skeptics.stackexchange.com/" title="scientific skepticism">Skeptics</a></li>
                        <li><a href="http://judaism.stackexchange.com/" title="those who base their lives on Jewish law and tradition and anyone interested in learning more">Mi Yodeya (Judaism)</a></li>
                        <li><a href="http://travel.stackexchange.com/" title="road warriors and seasoned travelers">Travel</a></li>
                        <li><a href="http://christianity.stackexchange.com/" title="committed Christians, experts in Christianity and those interested in learning more">Christianity</a></li>
                        <li><a href="http://gaming.stackexchange.com/" title="passionate videogamers on all platforms">Arqade (gaming)</a></li>
                        <li><a href="http://bicycles.stackexchange.com/" title="people who build and repair bicycles, people who train cycling, or commute on bicycles">Bicycles</a></li>
                        <li><a href="http://rpg.stackexchange.com/" title="gamemasters and players of tabletop, paper-and-pencil role-playing games">Role-playing Games</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#culturerecreation" class="more">
                                more (21)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://math.stackexchange.com/" title="people studying math at any level and professionals in related fields">Mathematics</a></li>
                        <li><a href="http://stats.stackexchange.com/" title="people interested in statistics, machine learning, data analysis, data mining, and data visualization">Cross Validated (stats)</a></li>
                        <li><a href="http://cstheory.stackexchange.com/" title="theoretical computer scientists and researchers in related fields">Theoretical Computer Science</a></li>
                        <li><a href="http://physics.stackexchange.com/" title="active researchers, academics and students of physics">Physics</a></li>
                        <li><a href="http://mathoverflow.net/" title="professional mathematicians">MathOverflow</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#science" class="more">
                                more (7)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://stackapps.com/" title="apps, scripts, and development with the Stack Exchange API">Stack Apps</a></li>
                        <li><a href="http://meta.stackoverflow.com/" title="meta-discussion of the Stack Exchange family of Q&amp;A websites">Meta Stack Overflow</a></li>
                        <li><a href="http://area51.stackexchange.com/" title="proposing new sites in the Stack Exchange network">Area 51</a></li>
                        <li><a href="http://careers.stackoverflow.com/">Stack Overflow Careers</a></li>
                    
                </ol>
            </td>
    </tr>
</tbody></table>
                </div>
            </div>

            <div id="copyright">
                site design / logo © 2014 stack exchange inc; user contributions licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license">cc by-sa 3.0</a> 
                with <a href="http://blog.stackoverflow.com/2009/06/attribution-required/" rel="license">attribution required</a>
            </div>
            <div id="svnrev">
                rev 2014.1.24.1327
            </div>
            
        </div>
    </div>
    <noscript>
        &lt;div id="noscript-warning"&gt;Stack Overflow works best with JavaScript enabled&lt;img src="http://pixel.quantserve.com/pixel/p-c1rF4kxgLUzNc.gif" alt="" class="dno"&gt;&lt;/div&gt;
    </noscript>
<script type="text/javascript">var p = "http", d = "static"; if (document.location.protocol == "https:") { p += "s"; d = "engine"; } var z = document.createElement("script"); z.type = "text/javascript"; z.async = true; z.src = p + "://" + d + ".adzerk.net/ados.js"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(z, s);</script>
<script type="text/javascript">
    var ados = ados || {};
    ados.run = ados.run || [];
    ados.run.push(function () { ados_setKeywords('python,string,pattern-matching,string-matching,dna-sequence');; ados_load(); });         
</script>

    <script type="text/javascript">
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () { (i[r].q = i[r].q || []).push(arguments) }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m);
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
        ga('create', 'UA-5620270-1');        
        
        ga('set', 'dimension2', '|python|string|pattern-matching|string-matching|dna-sequence|');         
        ga('send', 'pageview');
        var _qevents = _qevents || [],
            _comscore = _comscore || [];
        (function () {
            var ssl='https:'==document.location.protocol,
                s=document.getElementsByTagName('script')[0],
                qc=document.createElement('script');
            qc.type='text/javascript';
            qc.async=true;
            qc.src=(ssl?'https://secure':'http://edge')+'.quantserve.com/quant.js';
            s.parentNode.insertBefore(qc, s);
            var sc=document.createElement('script');
            sc.async=true;
            sc.src=(ssl?'https://sb':'http://b') + '.scorecardresearch.com/beacon.js';
            s.parentNode.insertBefore(sc, s);
        })();
        _comscore.push({ c1: "2", c2: "17440561" });
        _qevents.push({ qacct: "p-c1rF4kxgLUzNc" });
    </script>            

</body></html>